From: chris.gaffney@enron.com
To: darron.giron@enron.com, victor.guggenheim@enron.com, jason.wolfe@enron.com, 
Subject: MIME Attack Sample
Content-Type: text/plain;
	charset="Windows-1252"
Content-Transfer-Encoding: 7bit

 Free InsBuyer.com Agency Listing Free InsBuyer.com Agency Listing
 200,000 Visits and 10,00 leads generated EVERY MONTH!
 200,000 Visits and 10,00 leads generated EVERY MONTH!	


Life Insurance	 Annuities	 
Disability Insurance	 Health Insurance	 
Long Term Care Insurance	 Mortgage Insurance	 
Estate Planning	 Medicare Supplement Insurance	 
Pre-Paid Legal	 Dental nsurance	 
Travel Insurance	 Viatical Settlements	 
Auto Insurance	 Home Insurance	 

 Call or e-mail <mailto:drogers@insbuyer.com>  us today!
 877-596-8504
? or ?

Please fill out the form below for a free listing	 
Name:	  	
Company:	  	
Address:	  	
City:	  	State:	  	Zip:	  	
Phone:	  	
E-mail:	  	
Website:	  	 	
 	  	 	   	

InsBuyer.com - The Insurance Buyer's Guide <http://www.insbuyer.com> 
  
We don't want anyone to receive our mailings who does not wish to. This
is professional communication sent to insurance professionals. To be
removed from this mailing list, DO NOT REPLY to this message. Instead,
go here: http://www.Insurancemail.net <http://www.Insurancemail.net> 

Legal Notice <http://www.insuranceiq.com/legal.htm>  
 

------=_NextPart_000_346C22_01C1F83E.20E71340
Content-Type: text/html;
	charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable

<html>
<head>
<title>Free InsBuyer.com Agency Listing</title>
<meta http-equiv=3D"Content-Type" content=3D"text/html; =
charset=3Diso-8859-1">
</head>
<body bgcolor=3D"#FFFFFF" text=3D"#000000">
<table width=3D"550" cellpadding=3D"0" cellspacing=3D"2" =
bgcolor=3D"#000000" align=3D"center">
  <tr>=20
    <td>=20
      <table width=3D"100%" cellpadding=3D"0" cellspacing=3D"0" =
border=3D"0" bgcolor=3D"#000066">
        <tr>=20
          <td><img =
src=3D"http://63.211.81.87/images/insb/20020501-101.gif" width=3D"269" =
height=3D"169" alt=3D"Free InsBuyer.com Agency Listing"><img =
src=3D"http://63.211.81.87/images/insb/20020501-102.gif" width=3D"281" =
height=3D"169" alt=3D"Free InsBuyer.com Agency Listing"><br>
            <img =
src=3D"http://63.211.81.87/images/insb/20020501-103.gif" width=3D"550" =
height=3D"112" alt=3D"200,000 Visits and 10,00 leads generated EVERY =
MONTH!"><br>
            <img =
src=3D"http://63.211.81.87/images/insb/20020501-104.gif" width=3D"550" =
height=3D"73" alt=3D"200,000 Visits and 10,00 leads generated EVERY =
MONTH!"></td>
        </tr>
        <tr>=20
          <td =
background=3D"http://63.211.81.87/images/insb/20020501-105.gif"><br>
            <table border=3D"0" width=3D"90%" cellspacing=3D"0" =
cellpadding=3D"3" align=3D"center">
              <tr>=20
                <td width=3D"50%" align=3D"center"><font =
face=3D"Verdana" size=3D"2" color=3D"#FFFFFF"><b>Life =
Insurance</b></font></td>
                <td width=3D"50%" align=3D"center"><font =
face=3D"Verdana" size=3D"2" =
color=3D"#FFFFFF"><b>Annuities</b></font></td>
              </tr>
              <tr>=20
                <td width=3D"50%" align=3D"center"><font =
face=3D"Verdana" size=3D"2" color=3D"#FFFFFF"><b>Disability =
Insurance</b></font></td>
                <td width=3D"50%" align=3D"center"><font =
face=3D"Verdana" size=3D"2" color=3D"#FFFFFF"><b>Health =
Insurance</b></font></td>
              </tr>
              <tr>=20
                <td width=3D"50%" align=3D"center"><font =
face=3D"Verdana" size=3D"2" color=3D"#FFFFFF"><b>Long Term Care =
Insurance</b></font></td>
                <td width=3D"50%" align=3D"center"><font =
face=3D"Verdana" size=3D"2" color=3D"#FFFFFF"><b>Mortgage =
Insurance</b></font></td>
              </tr>
              <tr>=20
                <td width=3D"50%" align=3D"center"><font =
face=3D"Verdana" size=3D"2" color=3D"#FFFFFF"><b>Estate =
Planning</b></font></td>
                <td width=3D"50%" align=3D"center"><font =
face=3D"Verdana" size=3D"2" color=3D"#FFFFFF"><b>Medicare Supplement =
Insurance</b></font></td>
              </tr>
              <tr>=20
                <td width=3D"50%" align=3D"center"><font =
face=3D"Verdana" size=3D"2" color=3D"#FFFFFF"><b>Pre-Paid =
Legal</b></font></td>
                <td width=3D"50%" align=3D"center"><font =
face=3D"Verdana" size=3D"2" color=3D"#FFFFFF"><b>Dental =
nsurance</b></font></td>
              </tr>
              <tr>=20
                <td width=3D"50%" align=3D"center"><font =
face=3D"Verdana" size=3D"2" color=3D"#FFFFFF"><b>Travel =
Insurance</b></font></td>
                <td width=3D"50%" align=3D"center"><font =
face=3D"Verdana" size=3D"2" color=3D"#FFFFFF"><b>Viatical =
Settlements</b></font></td>
              </tr>
              <tr>=20
                <td width=3D"50%" align=3D"center"><font =
face=3D"Verdana" size=3D"2" color=3D"#FFFFFF"><b>Auto =
Insurance</b></font></td>
                <td width=3D"50%" align=3D"center"><font =
face=3D"Verdana" size=3D"2" color=3D"#FFFFFF"><b>Home =
Insurance</b></font></td>
              </tr>
            </table>
          </td>
        </tr>
        <tr>=20
          <td align=3D"center"><font face=3D"Arial, Helvetica, =
sans-serif" color=3D"#FFFFFF" size=3D"2"><b><br>
            &nbsp;Call or <a href=3D"mailto:drogers@insbuyer.com"><font =
color=3D"#00CCFF">e-mail</font></a> us today!<br>
            <img src=3D"http://63.211.81.87/images/insb/20020501-2.gif" =
width=3D"544" height=3D"66" alt=3D"877-596-8504"><br>
            &#151; or &#151;<br>
            <table width=3D"95%" bgcolor=3D"#000000">
              <tr>=20
                <form method=3D"post" =
action=3D"http://65.217.159.103/response/response.asp">
                  <td>=20
                    <table width=3D"100%" border=3D"0" cellspacing=3D"0" =
cellpadding=3D"2" align=3D"center" bgcolor=3D"#CCCCCC">
                      <tr>=20
                        <td colspan=3D"7" align=3D"center" =
bgcolor=3D"#333333"><b><font size=3D"2" color=3D"#FFFFFF">Please fill =
out the form below for a free listing</font></b></td>
                      </tr>
                      <tr>=20
                        <td width=3D"13%" align=3D"right"><b><font =
size=3D"2">Name:</font></b></td>
                        <td colspan=3D"6">=20
                          <input type=3D"text" name=3D"contactname" =
size=3D"50">
                        </td>
                      </tr>
                      <tr>=20
                        <td width=3D"13%" align=3D"right"><b><font =
size=3D"2">Company:</font></b></td>
                        <td colspan=3D"6">=20
                          <input type=3D"text" name=3D"company" =
size=3D"50">
                        </td>
                      </tr>
                      <tr>=20
                        <td width=3D"13%" align=3D"right"><b><font =
size=3D"2">Address:</font></b></td>
                        <td colspan=3D"6">=20
                          <input type=3D"text" name=3D"address" =
size=3D"50">
                        </td>
                      </tr>
                      <tr>=20
                        <td width=3D"13%" align=3D"right"><b><font =
size=3D"2">City:</font></b></td>
                        <td width=3D"20%">=20
                          <input type=3D"text" name=3D"city" =
size=3D"15">
                        </td>
                        <td width=3D"9%" align=3D"right"><b><font =
size=3D"2">State:</font></b></td>
                        <td width=3D"8%">=20
                          <input type=3D"text" name=3D"state" =
size=3D"2">
                        </td>
                        <td width=3D"9%" align=3D"right"><b><font =
size=3D"2">Zip:</font></b></td>
                        <td colspan=3D"2">=20
                          <input type=3D"text" name=3D"zip" size=3D"5">
                        </td>
                      </tr>
                      <tr>=20
                        <td width=3D"13%" align=3D"right"><b><font =
size=3D"2">Phone:</font></b></td>
                        <td colspan=3D"6">=20
                          <input type=3D"text" name=3D"phone" =
size=3D"50">
                        </td>
                      </tr>
                      <tr>=20
                        <td width=3D"13%" align=3D"right"><b><font =
size=3D"2">E-mail:</font></b></td>
                        <td colspan=3D"6">=20
                          <input type=3D"text" name=3D"email" =
size=3D"50">
                        </td>
                      </tr>
                      <tr>=20
                        <td width=3D"13%" align=3D"right"><b><font =
size=3D"2">Website:</font></b></td>
                        <td colspan=3D"5">=20
                          <input type=3D"text" name=3D"website" =
size=3D"50">
                        </td>
                        <td rowspan=3D"2" align=3D"center" =
width=3D"15%"><img src=3D"http://63.211.81.87/images/q.gif" width=3D"43" =
height=3D"50"></td>
                      </tr>
                      <tr>=20
                        <td width=3D"13%" align=3D"right">&nbsp;</td>
                        <td width=3D"20%">=20
                          <input type=3D"submit" name=3D"btnsubmit" =
value=3D"Submit">
                        </td>
                        <td width=3D"9%" align=3D"right">&nbsp;</td>
                        <td colspan=3D"3">=20
                          <input type=3D"hidden" =
name=3D"hdnRecipientTxt" value=3D"drogers@insbuyer.com">
                          <input type=3D"hidden" name=3D"hdnSubjectTxt" =
value=3D"InsBuyer Ad Inquiry">
                        </td>
                      </tr>
                    </table>
                  </td>
                </form>
              </tr>
            </table>
            <br>
            </b></font><a href=3D"http://www.insbuyer.com"><img =
src=3D"http://63.211.81.87/images/insb/20020501-3.gif" width=3D"462" =
height=3D"80" border=3D"0" alt=3D"InsBuyer.com - The Insurance Buyer's =
Guide"></a><br>
            &nbsp; </td>
        </tr>
      </table>
    </td>
  </tr>
  <tr>=20
    <td width=3D"100%" bgcolor=3D"#cccccc" align=3D"center">=20
      <p><font face=3D"Arial, Helvetica, sans-serif" size=3D"1"> We =
don't want anyone=20
        to receive our mailings who does not wish to. This is =
professional communication=20
        sent to insurance professionals. To be removed from this mailing =
list,=20
        <b>DO NOT REPLY</b> to this message. Instead, go here: <a =
href=3D"http://www.Insurancemail.net">=20
        http://www.Insurancemail.net</a></font></p>
    </td>
  </tr>
</table>
<center>
  <font face=3D"Arial, Helvetica, sans-serif" size=3D"1"><a =
href=3D"http://www.insuranceiq.com/legal.htm">Legal Notice</a></font>=20
</center>
<img height=3D'1' width=3D'1' border=3D'0' src=3D'304704'>
</body>
</html>

------=_NextPart_000_346C22_01C1F83E.20E71340--
Content-Type: text/html
<div style="display: none;"><plaintext>
Content-Type: text/plain
BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

[Moving to Samba-technical for dev discussion]

Danny,

> I am facing some difficulties in implementing the parser 
> function. Somehow - I keep getting a 'nca_s_fault_ndr' responses.
> 
> I guess this is due invalid parsing of parameters. I am 
> counting on the IDL specified here:
> 
> http://websvn.samba.org/cgi-bin/viewcvs.cgi/branches/SAMBA_4_0/source/librpc/idl/svcctl.idl?rev=18639&view=markup
> 
> 
> And having couple of problems:

First, are you using bzr for source control?  This would be
helpful in reviewing your patches.

If you need more details on using bzr with Samba svn trees,
See http://wiki.samba.org/index.php/Using_Bazaar_for_Samba_Development

>   1.
>      svcctl_CreateServiceW defines [in,size_is(dependencies_size)] 
> uint8 *dependencies and [in] uint32 dependencies_size.
> Which are uint8 type - I think I can use a RPC_DATA_BLOB
> for that. This type appear in several places - including
> the username/pass combination for the service user.
> Looking at a Windows packet created with the CreateService() 
> API, I can see the password is encrypted. I don't know
> how to resolve this issue.

What is the password length ?  I'd assume it is some derivative
of the the NTLM hash (it not the hash itself).

>   2. I am trying to create a simple service, ignoring 
>      all the complicated issues, that is: passing 'null'
>      at all places I don't have to implement. But yet - all
>      I am getting is a 'nca_s_fault_ndr'.

Something is off with the parsing functions.  Specifically the PDU you
are sending.

>   3. Questions:
>      1. How much should I count on the Samba4 IDL? How is it
>         generated? I found no official documentation on that.

It's generally very accurate although I remember having to flesh
out a few places where the svcctl calls were wrong.

>      2. Looking at the SMB package data I see that the
>         'Policy_handle' part is larger (in size) than the Windows
>         counterpart, my function does the same as the others
>         regarding this handle, so I am just ignoring this issue. Is
>         it wise?

The handle is always 20 bytes.  Can you send me a packet trace
to point out what you mean here ?

>      3. I don't quite understand if it matters to declare a pointer
>         in the code (UNISTR2 *str) and then use the prs_pointer()
>         function rather than declaring a variable (UNISTR2 str) and
>         using the smb_io_unistr2() function. I saw the latter do
>         some padding (prs_align()), but I keep getting gaps in my
>         packets which I can't explain - no matter which function I use.

Some rpc PDUs always have the string.  Others use a 32bit pointer
to indicate whether the string value is present or not.  These two
instances (a UNISTR2 and a UNIST2R2*) are parsed differently.






cheers, jerry
=====================================================================
Samba                                    ------- http://www.samba.org
Centeris                         -----------  http://www.centeris.com
"What man is a man who does not make the world better?"      --Balian
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.3 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iD8DBQFGHRSBIR7qMdg1EfYRAnXqAJ9ydo0Ur6mllerjF5Ta0/q2H0DiIQCfQChW
4KDmYe5wLlvOYlTt9C3D55M=
=zh7g
-----END PGP SIGNATURE-----

