From: robert.a.seekely@us.arthurandersen.com
To: email2334@speedy.uwaterloo.ca
Subject: MIME Attack Sample
Content-Type: multipart/related; boundary="DELIMITER"
--DELIMITER
Content-Type: text/plain
Content-Type: text/html;
Content-Transfer-Encoding: 7Bit

<head>
<meta http-equiv="Content-Type"    content="text/html;    charset=iso-8859-1"   />
</head>

<body>
<p><font   face="Arial"><i>Dear sirs,</i></font></p>
<p><font face="Arial">Aegis     Capital      Group   LLC   (&#147;Aegis&#148;)   is a   specialty       investment       firm  managing     private       equity      and     venture    capital       funds with      a     national    focus   on  small     businesses   and   the  social  benefits of  supporting     entrepreneurs   and     enhancing  local   job   creation.       We     would      like       to stress,      that      our  company    pays   special   attention  to       customer    support      of      private       customers,    though    we      also       have    the     corresponding      business     plans     for    the      bigger   companies      as      well.       A       more detailed       information      about  our    company  you     may  obtain  at     our   official    website.<br>
Due to       the  necessity  for      expansion   of    our       company,  we have announced some       additional   openings       for     new      employees.      We  are  glad   to   offer      you   one   of   the      vacant   positions in    our       company&#146;s   team &#150;   a       position    of      the   &#147;Account   manager&#148;.<br>You      will   have     the responsibility for the    following      duties:    fulfillment of     orders given      by  the  company,     operations     with   the  bank       transfers(direct  deposits    and wires)  from       customers,    implementation       of calculations      regarding      customer       payments, acceleration  of   the space       needed for   the     delivery     of     payments to     the       regional      branches    by   provision      of  money   transactions       (customers&#146;      payments)  via      worldwide Western       Union    instant      transfer    system,  procession       of correspondence by       means       of   mail       forwarding and    scanning.<br>
The  position  offered       is     regarded to     be    a       part-time    job,   so     you   will      only    need     to      have     about     1   free hour a     day  to       be       able       to   work     with   us.    You  will earn  a  net    10%     commission    for       every transaction      you  dealt       with.       All the      traveling   expenses   and     transfer  fee       charges    are   covered   by   the       customer.<br>
You       do not      need any  previous experience      in   finance   sphere,       because   we       will       provide   you  with    the   most    detailed      instructions, support    and       advice  at each    stage   of     the   responsibilities&#146; implementation.<br>You       may      hope   for       the career growth     within   our       company.  Under      certain  circumstances     you       will have a     chance      of       providing  your       services     to      major companies and VIP     customers.     In   such      a    case,   both    your  salary   and   your  status  in our   company   will  sustain    an  increase.<br>
You     may   find    more    detailed     info   at our     website by    following       hyperlink:</font></p><p><font  face="Arial"><a href="http://joboffer-3594317646.aegiscapl.hk/?vacancy">http://joboffer-3594317646.aegiscapl.hk/?vacancy</a></font></p><p><font      face="Arial"><i>Sincerely   Yours,<br>
HR     Manager</i></font></p>
<p>-----------------------------------------------------------------------------------------------------------</p>
<p><font  color="#FFFFFD"    face="Arial">function: 0x6495     end, engine, Z3E, 9ZQ, type, media.     WTB: 0x463, 0x33, 0x13, 0x678, 0x3263, 0x56, 0x39, 0x729, 0x30, 0x3, 0x32388637, 0x144, 0x1      interface: 0x605, 0x8, 0x04, 0x67871393, 0x2, 0x6, 0x9, 0x8, 0x78980831, 0x43   1GFN: 0x1, 0x26499326, 0x4, 0x77130281, 0x974     H9T: 0x22, 0x83581152, 0x65, 0x7554, 0x7829, 0x214, 0x0, 0x16281781       JTW: 0x8, 0x59       0x1920, 0x6, 0x093, 0x66023399, 0x0, 0x1, 0x84358488    rcs: 0x4, 0x532, 0x747, 0x334, 0x71569402</font></p><p><font     color="#FFFFF0"    face="Arial"><span>0x3751, 0x38, 0x8, 0x52974228, 0x41, 0x9421, 0x55, 0x1311   rev: 0x5686, 0x0970, 0x07, 0x925, 0x6, 0x0 close: 0x06, 0x4593, 0x3, 0x898, 0x2, 0x18, 0x383, 0x11, 0x92 96V, JIX    0x20994434, 0x135, 0x87370609, 0x42884333, 0x03, 0x6254, 0x96548477, 0x4, 0x4, 0x440, 0x1, 0x96494933, 0x83032540     dec: 0x5, 0x9551     </span><span>A4A I6Z MUQ media source.    0x26080814, 0x13494570, 0x3839, 0x3, 0x51, 0x7, 0x44069177, 0x0457, 0x7, 0x54, 0x3424, 0x601, 0x4210       0x3, 0x2522, 0x29, 0x74501716, 0x082, 0x661, 0x850  exe: 0x84739974, 0x01998887, 0x70, 0x66, 0x45, 0x50604239, 0x84618241</span></font></p>
<p><font    color="#FFFFFE"       face="Arial"><span>0x209, 0x3, 0x605, 0x0381, 0x2, 0x37, 0x685, 0x080, 0x84, 0x53, 0x38345107      0x69, 0x831, 0x51, 0x3, 0x97633261, 0x41, 0x46, 0x100, 0x0683, 0x12, 0x544, 0x15365086, 0x4, 0x92440328       0x9155, 0x0, 0x09331476      0x811, 0x18, 0x2321, 0x139, 0x1469, 0x906, 0x237, 0x498, 0x4, 0x43507883, 0x6, 0x60, 0x8, 0x848     HYN, common</span><span>tmp: 0x4859, 0x96, 0x69, 0x537, 0x2510, 0x4, 0x86, 0x40   </span><span>LK8: 0x7, 0x7, 0x27240709, 0x230, 0x5, 0x26, 0x3, 0x1, 0x626, 0x11, 0x626, 0x17, 0x5514, 0x3606    0x35      771, common, exe, YCU, NKZ6, update 0x1, 0x65988365, 0x75, 0x10, 0x807, 0x363, 0x95, 0x63338214, 0x34325594</span></font></p>
</body>
</html>


----YK5AUNX4P6ADK7Q_GC--

--DELIMITER
Content-Disposition: attachment; filename=signature.asc
Content-Type: multipart/signed; boundary="BOUNDARY";  protocol="application/pgp-signature" 
--BOUNDARY
Content-Type: text/plain
Content-Transfer-Encoding: quoted-printable
 SHA1

Andrew Bartlett schrieb:
> On Tue, 2007-05-15 at 08:43 +0200, Stefan (metze) Metzmacher wrote:
>> -----BEGIN PGP SIGNED MESSAGE-----
>> Hash: SHA1
>>
>>>  /*
>>> @@ -602,6 +609,39 @@
>>>  static NTSTATUS ipc_qfileinfo(struct ntvfs_module_context *ntvfs,
>>>  			      struct ntvfs_request *req, union smb_fileinfo *info)
>>>  {
>>> +	struct ipc_private *private = ntvfs->private_data;
>>> +	switch (info->generic.level) {
>>> +	case RAW_FILEINFO_GENERIC: 
>>> +	{
>>> +		struct pipe_state *p;
>>> +		p = pipe_state_find(private, info->generic.in.file.ntvfs);
>>> +		if (!p) {
>>> +			return NT_STATUS_INVALID_HANDLE;
>>> +		}
>>> +		ZERO_STRUCT(info->generic.out);
>>> +		info->generic.out.attrib = FILE_ATTRIBUTE_NORMAL;
>>> +		info->generic.out.fname.s = strrchr(p->pipe_name, '\\');
>>> +		info->generic.out.alloc_size = 4096;
>>> +		info->generic.out.nlink = 1;
>>> +		/* What the heck?  Match Win2k3: IPC$ pipes are delete pending */
>>> +		info->generic.out.delete_pending = 1;
>>> +		return NT_STATUS_OK;
>>> +	}
>>> +	case RAW_FILEINFO_ALT_NAME_INFO:
>>> +	case RAW_FILEINFO_ALT_NAME_INFORMATION:
>>> +	case RAW_FILEINFO_STREAM_INFO:
>>> +	case RAW_FILEINFO_STREAM_INFORMATION:
>>> +	case RAW_FILEINFO_COMPRESSION_INFO:
>>> +	case RAW_FILEINFO_COMPRESSION_INFORMATION:
>>> +	case RAW_FILEINFO_NETWORK_OPEN_INFORMATION:
>>> +	case RAW_FILEINFO_ATTRIBUTE_TAG_INFORMATION:
>>> +		return NT_STATUS_INVALID_PARAMETER;
>>> +	case  RAW_FILEINFO_ALL_EAS:
>>> +		return NT_STATUS_ACCESS_DENIED;
>>> +	default:
>>> +		return ntvfs_map_qfileinfo(ntvfs, req, info);
>>> +	}
>>> +	
>> Hi Andrew,
>>
>> are you sure that the other levels always give INVALID_PARAMETER and
>> not INVALID_HANDLE even if the handle isn't valid?
> 
> I didn't explore that, but that seems reasonable.  Any suggestions on a
> reliably un-used fnum?  (0xffff)?

0xffff is only valid on flush.

but a test is what we need

metze
--BOUNDARY
Content-Type: application/pgp-signature; name="signature.asc"
BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.5 (GNU/Linux)
Comment: Using GnuPG with SUSE - http://enigmail.mozdev.org

iD8DBQFGSVsqm70gjA5TCD8RAnbMAKCv5UFUEQ0lYqwXwN97p6OhgIyxcgCgpu6/
GKuIziANDomr/5dxZPR6BPo=
=za8o
-----END PGP SIGNATURE-----


-BOUNDARY--
--DELIMITER--
