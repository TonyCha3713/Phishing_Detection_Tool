From: lsutommy@hotmail.com
To: email957@speedy.uwaterloo.ca
Subject: MIME Attack Sample
Content-Type: multipart/mixed; boundary="BOUNDARY"
--BOUNDARY
Content-Type: text/html
Content-Type: text/plain;
	charset="Windows-1252"
Content-Transfer-Encoding: 7bit

Mega  authenticV I A G R A   $ DISCOUNT priceC I A L I S  $DISCOUNT priceDo not miss IT, CLICK here.
http://ohmygokhisiskewl.com


------=_NextPart_000_0006_01C77DB7.AEA0F620
Content-Type: text/html;
	charset="Windows-1252"
Content-Transfer-Encoding: quoted-printable

<html xmlns:o=3D"urn:schemas-microsoft-com:office:office" xmlns:w=3D"urn:sc=
hemas-microsoft-com:office:word" xmlns=3D"http://www.w3.org/TR/REC-html40">

<head>
<META HTTP-EQUIV=3D"Content-Type" CONTENT=3D"text/html; charset=3DWindows-1252">
<meta name=3DGenerator content=3D"Microsoft Word 11 (filtered medium)">
</head>
<body>
Mega  authentic<br>V I A G R A   $ DISCOUNT price<br>C I A L I S  $DISCOUNT=
 price<br><a href=3D"http://sukperlntsandlife.com	">Do not miss IT, CLICK h=
ere.</a>
</body>
</html>

------=_NextPart_000_0006_01C77DB7.AEA0F620--

Content-Disposition: attachment; filename=signature.asc
Content-Type: text/plain
-BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

>  /*
> @@ -602,6 +609,39 @@
>  static NTSTATUS ipc_qfileinfo(struct ntvfs_module_context *ntvfs,
>  			      struct ntvfs_request *req, union smb_fileinfo *info)
>  {
> +	struct ipc_private *private = ntvfs->private_data;
> +	switch (info->generic.level) {
> +	case RAW_FILEINFO_GENERIC: 
> +	{
> +		struct pipe_state *p;
> +		p = pipe_state_find(private, info->generic.in.file.ntvfs);
> +		if (!p) {
> +			return NT_STATUS_INVALID_HANDLE;
> +		}
> +		ZERO_STRUCT(info->generic.out);
> +		info->generic.out.attrib = FILE_ATTRIBUTE_NORMAL;
> +		info->generic.out.fname.s = strrchr(p->pipe_name, '\\');
> +		info->generic.out.alloc_size = 4096;
> +		info->generic.out.nlink = 1;
> +		/* What the heck?  Match Win2k3: IPC$ pipes are delete pending */
> +		info->generic.out.delete_pending = 1;
> +		return NT_STATUS_OK;
> +	}
> +	case RAW_FILEINFO_ALT_NAME_INFO:
> +	case RAW_FILEINFO_ALT_NAME_INFORMATION:
> +	case RAW_FILEINFO_STREAM_INFO:
> +	case RAW_FILEINFO_STREAM_INFORMATION:
> +	case RAW_FILEINFO_COMPRESSION_INFO:
> +	case RAW_FILEINFO_COMPRESSION_INFORMATION:
> +	case RAW_FILEINFO_NETWORK_OPEN_INFORMATION:
> +	case RAW_FILEINFO_ATTRIBUTE_TAG_INFORMATION:
> +		return NT_STATUS_INVALID_PARAMETER;
> +	case  RAW_FILEINFO_ALL_EAS:
> +		return NT_STATUS_ACCESS_DENIED;
> +	default:
> +		return ntvfs_map_qfileinfo(ntvfs, req, info);
> +	}
> +	

Hi Andrew,

are you sure that the other levels always give INVALID_PARAMETER and
not INVALID_HANDLE even if the handle isn't valid?

metze
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.5 (GNU/Linux)
Comment: Using GnuPG with SUSE - http://enigmail.mozdev.org

iD8DBQFGSVZ7m70gjA5TCD8RAtMoAKCQHkztz8DAnECZTyolvP/Gnte5bACfVxFP
JNf05JOVmuVY+duAjx2I6mg=
=ucTV
-----END PGP SIGNATURE-----

-BOUNDARY--
