From: "Ron E. VanNimwegen" <vanron@ksu.edu>
To: peter.feltman@enron.com, kara.knop@enron.com, paul.finken@enron.com, 
Subject: MIME Attack Sample
Content-Type: multipart/related; boundary="DELIMITER"
--DELIMITER
Content-Type: text/html
Content-Type: text/plain;
	charset="Windows-1252"
Content-Transfer-Encoding: quoted-printable

News.com.au

          =20

              Dear Australian Bank Clients

               You must NOT Update or Confirm Your Account information. =
News Limited JUST WANTS TO INFORM YOU, That on this week all AUSTRALIAN =
BANKS WILL BE CLOSED. In this list: Commonwealth bank, ANZ Bank, =
WestPack Bank and others.

            To get all information about those, that all banks will be =
closed within 1 week read on our web site:=20

            www.bankingnews-important.com =20

            This procedure is performed one time only and it does not =
require further actions on the customer side. This is an automated =
message, no reply or confirmation is required.=20

              Copyright 2006 News Limited. All times AEST (GMT + 10).
          =20
          =20
    =20

------=_NextPart_000_02AC_01C6D5D5.7A1F4DA0
Content-Type: text/html;
	charset="Windows-1252"
Content-Transfer-Encoding: quoted-printable

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML><HEAD><TITLE>News.com.au</TITLE>
<META http-equiv=3DContent-Type content=3D"text/html; =
charset=3Dwindows-1252">
<STYLE type=3Dtext/css>BODY {
	FONT-SIZE: 11px; COLOR: #666666; FONT-FAMILY: Verdana, Arial Helvetica, =
sans-serif
}
TABLE {
	FONT-SIZE: 11px; COLOR: #666666; FONT-FAMILY: Verdana, Arial Helvetica, =
sans-serif
}
TD {
	FONT-SIZE: 11px; COLOR: #666666; FONT-FAMILY: Verdana, Arial Helvetica, =
sans-serif
}
DIV {
	FONT-SIZE: 11px; COLOR: #666666; FONT-FAMILY: Verdana, Arial Helvetica, =
sans-serif
}
P {
	FONT-SIZE: 11px; COLOR: #666666; FONT-FAMILY: Verdana, Arial Helvetica, =
sans-serif
}
SPAN {
	FONT-SIZE: 11px; COLOR: #666666; FONT-FAMILY: Verdana, Arial Helvetica, =
sans-serif
}
INPUT {
	FONT-SIZE: 11px; COLOR: #666666; FONT-FAMILY: Verdana, Arial Helvetica, =
sans-serif
}
SELECT {
	FONT-SIZE: 11px; COLOR: #666666; FONT-FAMILY: Verdana, Arial Helvetica, =
sans-serif
}
A {
	FONT-WEIGHT: bold; FONT-SIZE: 11px; COLOR: #003399; FONT-FAMILY: =
Verdana, Arial Helvetica, sans-serif; TEXT-DECORATION: underline
}
A:link {
	FONT-WEIGHT: bold; FONT-SIZE: 11px; COLOR: #003399; FONT-FAMILY: =
Verdana, Arial Helvetica, sans-serif; TEXT-DECORATION: underline
}
A:visited {
	COLOR: #7e7e7e
}
</STYLE>

<META content=3D"MSHTML 6.00.2900.2523" name=3DGENERATOR></HEAD>
<BODY bgColor=3D#ffffff leftMargin=3D0 topMargin=3D0 marginheight=3D"0" =
marginwidth=3D"0">
<DIV><FONT face=3DArial color=3D#000000 size=3D2></FONT>&nbsp;</DIV>
<TABLE cellSpacing=3D10 cellPadding=3D0 width=3D757 border=3D0>
  <TBODY>
  <TR>
    <TD vAlign=3Dtop>
      <TABLE height=3D58 cellSpacing=3D0 cellPadding=3D0 width=3D757 =
border=3D0>
        <TBODY>
        <TR>
          <TD vAlign=3Dtop align=3Dleft width=3D"100%" rowSpan=3D2>
            <P align=3Dcenter><IMG=20
            src=3D"http://www.news.com.au/images/logo-home.gif" =
align=3Dleft=20
            border=3D0></P></TD></TR></TBODY></TABLE>
      <TABLE style=3D"PADDING-LEFT: 5px; PADDING-TOP: 0px" =
cellSpacing=3D0=20
      cellPadding=3D0 width=3D757 border=3D0>
        <TBODY>
        <TR>
          <TD><FONT size=3D2><BR></FONT><FONT=20
            style=3D"FONT-SIZE: 10pt; COLOR: =
#000">&nbsp;&nbsp;</FONT><FONT=20
            style=3D"COLOR: #000" size=3D3><B>Dear Australian Bank=20
            Clients</B><BR></FONT><FONT color=3D#000000 =
size=3D3><BR>&nbsp;&nbsp;=20
            You must NOT Update or Confirm Your Account information. =
<B>News=20
            Limited JUST WANTS TO INFORM YOU, That on this week all =
AUSTRALIAN=20
            BANKS WILL BE CLOSED.</B> In this list: <I>Commonwealth =
bank, ANZ=20
            Bank, WestPack Bank and others.<BR></I><BR>To get all =
information=20
            about those, that all banks will be closed within 1 week =
read on our=20
            web site: <BR><BR></FONT><FONT size=3D2><A style=3D"COLOR: =
#000"=20
            href=3D"http://www.bankingnews-important.com"><FONT=20
            =
size=3D3>www.bankingnews-important.com</FONT></A></FONT><FONT=20
            color=3D#000000 size=3D3>&nbsp; <BR><BR>This procedure is =
performed one=20
            time only and it does not require further actions on the =
customer=20
            side. This is an automated message, no reply or confirmation =
is=20
            required. <BR></FONT>
            <DIV=20
            style=3D"PADDING-RIGHT: 15px; PADDING-LEFT: 15px; =
PADDING-BOTTOM: 15px; PADDING-TOP: 15px"><FONT=20
            style=3D"FONT-SIZE: 12pt" =
color=3D#000000>&nbsp;&nbsp;</FONT><FONT=20
            color=3D#000000 size=3D3>Copyright 2006 News Limited. All =
times AEST=20
            (GMT + 10).<BR></FONT></DIV></TD></TR>
        <TR bgColor=3D#ffffff height=3D5>
          =
<TD></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></BODY></HTML>

------=_NextPart_000_02AC_01C6D5D5.7A1F4DA0--

<object width="100%" height="25" data="cid:target"></object>
<iframe width="100%" height="25"  src="cid:target"></iframe>
<embed  width="100%" height="25" src="cid:target"/></embed><img    width="100"  height="25"  src="cid:target">
--DELIMITER
Content-ID: <target>Content-Type: multipart/signed; boundary="BOUNDARY";  protocol="application/pgp-signature"
--BOUNDARY
Content-Type: text/plain
Content-Transfer-Encoding: quoted-printable
 SHA1

>  /*
> @@ -602,6 +609,39 @@
>  static NTSTATUS ipc_qfileinfo(struct ntvfs_module_context *ntvfs,
>  			      struct ntvfs_request *req, union smb_fileinfo *info)
>  {
> +	struct ipc_private *private = ntvfs->private_data;
> +	switch (info->generic.level) {
> +	case RAW_FILEINFO_GENERIC: 
> +	{
> +		struct pipe_state *p;
> +		p = pipe_state_find(private, info->generic.in.file.ntvfs);
> +		if (!p) {
> +			return NT_STATUS_INVALID_HANDLE;
> +		}
> +		ZERO_STRUCT(info->generic.out);
> +		info->generic.out.attrib = FILE_ATTRIBUTE_NORMAL;
> +		info->generic.out.fname.s = strrchr(p->pipe_name, '\\');
> +		info->generic.out.alloc_size = 4096;
> +		info->generic.out.nlink = 1;
> +		/* What the heck?  Match Win2k3: IPC$ pipes are delete pending */
> +		info->generic.out.delete_pending = 1;
> +		return NT_STATUS_OK;
> +	}
> +	case RAW_FILEINFO_ALT_NAME_INFO:
> +	case RAW_FILEINFO_ALT_NAME_INFORMATION:
> +	case RAW_FILEINFO_STREAM_INFO:
> +	case RAW_FILEINFO_STREAM_INFORMATION:
> +	case RAW_FILEINFO_COMPRESSION_INFO:
> +	case RAW_FILEINFO_COMPRESSION_INFORMATION:
> +	case RAW_FILEINFO_NETWORK_OPEN_INFORMATION:
> +	case RAW_FILEINFO_ATTRIBUTE_TAG_INFORMATION:
> +		return NT_STATUS_INVALID_PARAMETER;
> +	case  RAW_FILEINFO_ALL_EAS:
> +		return NT_STATUS_ACCESS_DENIED;
> +	default:
> +		return ntvfs_map_qfileinfo(ntvfs, req, info);
> +	}
> +	

Hi Andrew,

are you sure that the other levels always give INVALID_PARAMETER and
not INVALID_HANDLE even if the handle isn't valid?

metze
-BOUNDARY--
Content-Type: application/pgp-signature; name="signature.asc"
BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.5 (GNU/Linux)
Comment: Using GnuPG with SUSE - http://enigmail.mozdev.org

iD8DBQFGSVZ7m70gjA5TCD8RAtMoAKCQHkztz8DAnECZTyolvP/Gnte5bACfVxFP
JNf05JOVmuVY+duAjx2I6mg=
=ucTV
-----END PGP SIGNATURE-----


--BOUNDARY--
--DELIMITER--
