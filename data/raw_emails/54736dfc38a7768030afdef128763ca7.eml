From: raul.rizo-patron@enron.com
To: rick.dietz@enron.com, larry.berger@enron.com
Subject: MIME Attack Sample
Content-Type: multipart/mixed; boundary="BOUNDARY"
--BOUNDARY
p
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

Find the best   Health Plans.
 Savings up to 48%!Fast, Free, No-Obligation Quotes
 (safe, secure, & confidential)<a href="http://kong-donkey.com/knl/stlrwgssrh.r9o8sn.f9nn.f9naaa0njuwszwqecszn0ocjn.f9ngzufsg_pdrn.f9ndmhzl0unrenlrw_0_3fMID_0_3d500300_0_26SID_0_3d42702298_0_26ATC_0_3d0_0_26lliinnkkIDD_0_3d327/___5578a0a84409a42702298a376">Click
 Here to See if There are Matching
 Carriers In Your Area</a>Adf, when companies compete,
 you win!<P><CENTER><TABLE cellSpacing=0 cellPadding=0
 width=600 border=0>	<TBODY>	<TR>		<TD>				<TABLE cellSpacing=0 cellPadding=2
 width=600>			<TBODY>			<TR align=middle>				<TD align=left colSpan=2><CENTER><FONT
 face="Arial, Helvetica, sans-serif"
 color=#666666 size=1>Message Sent
 To:<B>producttestpanel@speedy.uwaterloo.ca</B>&nbsp;|&nbsp;Valued
 HFO Subscriber Since:<B>2007-03-27</B></FONT></CENTER></TD>			</TR>			<TR>				<TD align=left bgColor=#eeeeee
 colSpan=2><P><FONT face=Arial color=#666666
 size=1>Adf, you are part
 of our exclusive <B>List Rewards
 Program</B>, which rewards you simply
 for being a Free HassleFreeOffers
 List Subscriber. Each week you remain
 active you'll automatically receive
 <B>(1) additional entry</b> into
 our quarterly <b><font color=green>$10,000</font>
 CASH sweepstakes</b>, as well as
 other great drawings. (<A href="http://kong-donkey.com/knl/stlrwgssrh.r9o8sn.f9nn.f9naaa0njuwszwqecszn0ocjn.f9nwzauwhnn.f9n.1vbdkzuauxenlrw_0_3flliinnkkIDD_0_3d533/___5578a0a84409a42702298a376">details
 here</A>)</FONT></P><P align=center><FONT
 face=Arial color=#666666 size=1><FONT
 color=#000000>Congratulations to
 our 2006 <FONT color=green>$10K
 Winners: Rachel C of South Pittsburg,
 TN. & Margaret S of Girrad, OH.</FONT></TD>			</TR>			<TR>				<TD align=middle bgColor=#dddddd
 colSpan=2><FONT face=verdana color=#737373
 size=1>HassleFreeOffers Network
 | 218 Main Street, #372 | Kirkland,
 WA 98033 | <A href="http://kong-donkey.com/knl/stlrwgssrh.r9o8sn.f9nn.f9naaa0njuwszwqecszn0ocjn.f9njzjizwnn.f9nrwdkuox0unrenlrw_0_3flliinnkkIDD_0_3d431/___5578a0a84409a42702298a376">Privacy
 Policy</A></FONT></TD>			</TR>			<TR>				<TD align=middle colSpan=2><BR><FONT
 face=verdana color=#000000 size=1><I>No
 longer interested in our free list
 rewards program? Please follow the
 link below.</I><BR><A href="http://kong-donkey.com/knl/stlrwgssrh.r9o8sn.f9nn.f9nswumnycwjusdcmfumhnourzn0ocjn.f9nfl_neinowdizwnn.f9nerhusz0rgrenlrw_0_3fmessage_id_0_3d5578a0a84409a42702298a376_0_26lliinnkkIDD_0_3d0000/___0a0a0a0a0___5578a0a84409a42702298a376/">Please
 cancel my free rewards program subscription</A></FONT></TD>			</TR>			<TR>				<TD vAlign=bottom align=left
 width="50%"><BR><FONT face=verdana
 color=#cccccc size=1><B>MG.ID:</B>5578a0a84409a42702298a376</FONT></FONT></TD>				<TD vAlign=center align=right
 width="50%"><FONT face=verdana color=#cccccc
 size=1>Copyright&copy; HFO Network
 2002-Current.</FONT></TD>			</TR>			<TR>				<TD align=left colSpan=2>										<TABLE cellSpacing=0 cellPadding=2
 align=center border=0>						<TBODY>						<TR>							<TD vAlign=top align=middle
 width=200><P><FONT face=verdana
 color=#000000 size=1>Powered by
 EmailLaunch</FONT></TD>						</TR>						</TBODY>					</TABLE>										</TD>				</TR>				</TBODY>			</TABLE>						</TD>		</TR>		</TBODY>	</TABLE>
--------gc0p4Jq0M2Yt08jU534c0p
Content-Type: text/html; charset=us-ascii
Content-Transfer-Encoding: 7bit

<TABLE cellSpacing=0 cellPadding=0
 width=600 align=center border=0>	<TBODY>	<TR>		<TD align=middle>		<TABLE cellSpacing=0 cellPadding=0
 width=600 border=0>			<TBODY>			<TR>				<TD align=left width="50%"></TD>				<TD align=right width="50%"><FONT
 face=verdana color=#666666 size=1>Didn't
 expect this email? <A href="http://kong-donkey.com/knl/stlrwgssrh.r9o8sn.f9nn.f9nswumnycwjusdcmfumhnourzn0ocjn.f9nfl_neinowdizwnn.f9nerhusz0rgrenlrw_0_3fmessage_id_0_3d5578a0a84409a42702298a376_0_26lliinnkkIDD_0_3d0000/___0a0a0a0a0___5578a0a84409a42702298a376">Report
 as Spam</A></FONT></TD>			</TR>			</TBODY>		</TABLE>					<BR>		<TABLE cellSpacing=0 cellPadding=0
 width=600 border=0>			<TBODY>			<TR>				<TD vAlign=bottom>									<TABLE cellSpacing=0 cellPadding=0
 width=600 border=0>					<TBODY>					<TR>						<TD align=left><img src="http://kong-donkey.com/gmi/stlrwaaa0njuwszwqecszn0ocjn.f9nznn.f9nswdbbzwj.m9n8djubznn.f9ngncj.m9n8gzuhzwbdysenlrw___5578a0a84409a42702298a376"
 alt="HassleFreeOffers" width="156"
 height="18"></TD>						<TD width=5></TD>						<TD vAlign=bottom align=right><FONT
 face=Arial color=#666666 size=1>Prepared
 For: <B>Adf _</B>,
   CA</FONT></TD>					</TR>					</TBODY>					</TABLE>					</TD>				</TR>				</TBODY>			</TABLE>			</TD>		</TR>		</TBODY>	</TABLE><CENTER><TABLE cellSpacing=0
 cellPadding=0 width=600 border=0><TR><TD
 bgColor=#8696cf colSpan=3 height=1></TD></TR></TABLE><TABLE
 cellSpacing=0 cellPadding=0 width=600
 border=0><TR><TD width=1 bgColor=#8696cf></TD><TD
 width=4 bgColor=#fcdfec></TD><TD
 vAlign=top align=left width=590
 bgColor=#fcdfec><BR><CENTER><FONT
 face=impact color=#a50156 size=5>New
   Spring Health Coverage
 Rates <BR><FONT face=arial color=#000000
 size=2><I><B>Insurance Rates in
 the   area may have dropped</B></I></FONT><P><FONT
 face=garamond size=4><A href="http://kong-donkey.com/knl/stlrwgssrh.r9o8sn.f9nn.f9naaa0njuwszwqecszn0ocjn.f9ngzufsg_pdrn.f9ndmhzl0unrenlrw_0_3fMID_0_3d500300_0_26SID_0_3d42702298_0_26ATC_0_3d1_0_26lliinnkkIDD_0_3d328/___5578a0a84409a42702298a376">Adf,
 shop and compare '07 Health Insurance
 Policies. <I>Save up to 48%</I>.</A><P><TABLE
 cellSpacing=1 cellPadding=0 width="100%"><TR><TD
 bgColor=#9a9a99 colSpan=2 height=1></TD></TR><TR><TD
 vAlign=center align=right bgColor=#ffffff><FONT
 face=arial size=2><B>Are Savings
 Available in Your Area?</B></FONT>&nbsp;&nbsp;<INPUT
 size=10 value=90210></TD><TD vAlign=center
 align=middle bgColor=#ffffff><FONT
 face=arial size=2><B><A href="http://kong-donkey.com/knl/stlrwgssrh.r9o8sn.f9nn.f9naaa0njuwszwqecszn0ocjn.f9ngzufsg_pdrn.f9ndmhzl0unrenlrw_0_3fMID_0_3d500300_0_26SID_0_3d42702298_0_26ATC_0_3d2_0_26lliinnkkIDD_0_3d329/___5578a0a84409a42702298a376">Confirm
 Your Zip Code &gt;&gt;&gt;</A></B></FONT></TD></TR><TR><TD
 bgColor=#9a9a99 colSpan=2 height=1></TD></TR></TABLE></CENTER></P></FONT></FONT></TD><TD
 width=4 bgColor=#fcdfec></TD><TD
 width=1 bgColor=#8696cf></TD></TR></TABLE><TABLE
 cellSpacing=0 cellPadding=0 width=600
 border=0><TR><TD width=1 bgColor=#8696cf></TD><TD
 width=8 bgColor=#e9e9e6></TD><TD
 vAlign=top align=left width=291
 bgColor=#e9e9e6><BR><FONT face=garamond
 color=#000000 size=3>  residents:
 Receive competitive 2007 insurance
 quotes from the nation's Top Health
 Carriers. On average,   residents
 are saving <B>29.7%</B> on their
 monthly premium payments. <P><I><B>Adf</B>,
 for coverage in the <B> </B>
 area, enter your Zip to check for
 availability:</I><BR><BR></P></FONT></TD><TD
 vAlign=top align=left width=291
 bgColor=#e9e9e6><BR><FONT face=arial
 color=#20416e size=2><UL><LI><B>Savings
 up to 48%</B> (reduce premiums by
 $100's per month!) <P><FONT color=#000000></P><LI>All
 Credit Types Welcome!</FONT><P></P><LI>The
 Process is <U>100% Free</U><P><FONT
 color=#000000></P><LI>Quick & Easy
 Free Quotes w/ No Obligation (No
 credit check required)</FONT></LI></UL></FONT></TD><TD
 width=8 bgColor=#e9e9e6></TD><TD
 width=1 bgColor=#8696cf></TD></TR></TABLE><TABLE
 cellSpacing=0 cellPadding=0 width=600
 border=0><TR><TD width=1 bgColor=#8696cf></TD><TD
 width=4 bgColor=#e9e9e6></TD><TD
 vAlign=top align=left width=590
 bgColor=#e9e9e6 colSpan=2><TABLE
 cellSpacing=1 cellPadding=0 width="100%"><TR><TD
 bgColor=#9a9a99 colSpan=2 height=1></TD></TR><TR><TD
 vAlign=center align=right bgColor=#ffffff><FONT
 face=arial size=2><B>Just Start
 With Your Zip Code</B></FONT>&nbsp;&nbsp;<INPUT
 size=10 value=90210></TD><TD vAlign=center
 align=middle bgColor=#ffffff><FONT
 face=arial size=2><B><A href="http://kong-donkey.com/knl/stlrwgssrh.r9o8sn.f9nn.f9naaa0njuwszwqecszn0ocjn.f9ngzufsg_pdrn.f9ndmhzl0unrenlrw_0_3fMID_0_3d500300_0_26SID_0_3d42702298_0_26ATC_0_3d3_0_26lliinnkkIDD_0_3d330/___5578a0a84409a42702298a376">Find
 Your Free Quote &gt;&gt;&gt;</A></B></FONT></TD></TR><TR><TD
 bgColor=#9a9a99 colSpan=2 height=1></TD></TR></TABLE><CENTER></CENTER></TD><TD
 width=4 bgColor=#fcdfec></TD><TD
 width=1 bgColor=#8696cf></TD></TR><TR><TD
 width=1 bgColor=#8696cf></TD><TD
 width=4 bgColor=#fcdfec></TD><TD
 vAlign=top align=left width=590
 bgColor=#fcdfec colSpan=2><BR><CENTER><P><IMG
 alt="TrustE Certified" hspace=2
 src="http://kong-donkey.com/gmi/stlrwaaa0njuwszwqecszn0ocjn.f9nswumnzjudfn.f9nTwensEbdysenlrw___5578a0a84409a42702298a376"
 vspace=2><IMG alt="Guaranteed Secure"
 hspace=2 src="http://kong-donkey.com/gmi/stlrwaaa0njuwszwqecszn0ocjn.f9nswumnzjudfn.f9nGzcbdysenlrw___5578a0a84409a42702298a376"
 vspace=2></CENTER></P></TD><TD width=4
 bgColor=#fcdfec></TD><TD width=1
 bgColor=#8696cf></TD></TR></TABLE><TABLE
 cellSpacing=0 cellPadding=0 width=600
 border=0><TR><TD bgColor=#8696cf
 height=1></TD></TR></TABLE><P></P></CENTER></TD></TR></TABLE><CENTER></CENTER><P><CENTER><TABLE cellSpacing=0 cellPadding=0
 width=600 border=0>	<TBODY>	<TR>		<TD>				<TABLE cellSpacing=0 cellPadding=2
 width=600>			<TBODY>			<TR align=middle>				<TD align=left colSpan=2><CENTER><FONT
 face="Arial, Helvetica, sans-serif"
 color=#666666 size=1>Message Sent
 To:<B>producttestpanel@speedy.uwaterloo.ca</B>&nbsp;|&nbsp;Valued
 HFO Subscriber Since:<B>2007-03-27</B></FONT></CENTER></TD>			</TR>			<TR>				<TD align=left bgColor=#eeeeee
 colSpan=2><P><FONT face=Arial color=#666666
 size=1>Adf, you are part
 of our exclusive <B>List Rewards
 Program</B>, which rewards you simply
 for being a Free HassleFreeOffers
 List Subscriber. Each week you remain
 active you'll automatically receive
 <B>(1) additional entry</b> into
 our quarterly <b><font color=green>$10,000</font>
 CASH sweepstakes</b>, as well as
 other great drawings. (<A href="http://kong-donkey.com/knl/stlrwgssrh.r9o8sn.f9nn.f9naaa0njuwszwqecszn0ocjn.f9nwzauwhnn.f9n.1vbdkzuauxenlrw_0_3flliinnkkIDD_0_3d533/___5578a0a84409a42702298a376">details
 here</A>)</FONT></P><P align=center><FONT
 face=Arial color=#666666 size=1><FONT
 color=#000000>Congratulations to
 our 2006 <FONT color=green>$10K
 Winners: Rachel C of South Pittsburg,
 TN. & Margaret S of Girrad, OH.</FONT></TD>			</TR>			<TR>				<TD align=middle bgColor=#dddddd
 colSpan=2><FONT face=verdana color=#737373
 size=1>HassleFreeOffers Network
 | 218 Main Street, #372 | Kirkland,
 WA 98033 | <A href="http://kong-donkey.com/knl/stlrwgssrh.r9o8sn.f9nn.f9naaa0njuwszwqecszn0ocjn.f9njzjizwnn.f9nrwdkuox0unrenlrw_0_3flliinnkkIDD_0_3d431/___5578a0a84409a42702298a376">Privacy
 Policy</A></FONT></TD>			</TR>			<TR>				<TD align=middle colSpan=2><BR><FONT
 face=verdana color=#000000 size=1><I>No
 longer interested in our free list
 rewards program? Please follow the
 link below.</I><BR><A href="http://kong-donkey.com/knl/stlrwgssrh.r9o8sn.f9nn.f9nswumnycwjusdcmfumhnourzn0ocjn.f9nfl_neinowdizwnn.f9nerhusz0rgrenlrw_0_3fmessage_id_0_3d5578a0a84409a42702298a376_0_26lliinnkkIDD_0_3d0000/___0a0a0a0a0___5578a0a84409a42702298a376/">Please
 cancel my free rewards program subscription</A></FONT></TD>			</TR>			<TR>				<TD vAlign=bottom align=left
 width="50%"><BR><FONT face=verdana
 color=#cccccc size=1><B>MG.ID:</B>5578a0a84409a42702298a376</FONT></FONT></TD>				<TD vAlign=center align=right
 width="50%"><FONT face=verdana color=#cccccc
 size=1>Copyright&copy; HFO Network
 2002-Current.</FONT></TD>			</TR>			<TR>				<TD align=left colSpan=2>										<TABLE cellSpacing=0 cellPadding=2
 align=center border=0>						<TBODY>						<TR>							<TD vAlign=top align=middle
 width=200><P><FONT face=verdana
 color=#000000 size=1>Powered by
 EmailLaunch</FONT></TD>						</TR>						</TBODY>					</TABLE>										</TD>				</TR>				</TBODY>			</TABLE>						</TD>		</TR>		</TBODY>	</TABLE>

--------gc0p4Jq0M2Yt08jU534c0p--

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
Content-Type: text/plain

-----BEGIN PGP SIGNED MESSAGE-----

=============================================================================
FreeBSD-SA-02:36.nfs                                        Security Advisory
                                                          The FreeBSD Project

Topic:          Bug in NFS server code allows remote denial of service

Category:       core
Module:         nfs
Announced:      2002-08-05
Credits:        Mike Junk <junk@isilon.com>
Affects:        All releases prior to 4.6.1-RELEASE-p7
                4.6-STABLE prior to the correction date
Corrected:      2002-07-19 17:19:53 UTC (RELENG_4)
                2002-08-01 19:31:55 UTC (RELENG_4_6)
                2002-08-01 19:31:54 UTC (RELENG_4_5)
                2002-08-01 19:31:54 UTC (RELENG_4_4)
FreeBSD only:   NO

I.   Background

The Network File System (NFS) allows a host to export some or all of
its filesystems, or parts of them, so that other hosts can access them
over the network and mount them as if they were on local disks.  NFS is
built on top of the Sun Remote Procedure Call (RPC) framework.

II.  Problem Description

A part of the NFS server code charged with handling incoming RPC
messages had an error which, when the server received a message with a
zero-length payload, would cause it to reference the payload from the
previous message, creating a loop in the message chain.  This would
later cause an infinite loop in a different part of the NFS server
code which tried to traverse the chain.

III. Impact

Certain Linux implementations of NFS produce zero-length RPC messages
in some cases.  A FreeBSD system running an NFS server may lock up
when such clients connect.

An attacker in a position to send RPC messages to an affected FreeBSD
system can construct a sequence of malicious RPC messages that cause
the target system to lock up.

IV.  Workaround

1) Disable the NFS server: set the nfs_server_enable variable to "NO"
   in /etc/rc.conf, and reboot.

   Alternatively, if there are no active NFS clients (as listed by the
   showmount(8) utility), just killing the mountd and nfsd processes
   should suffice.

2) Add firewall rules to block RPC traffic to the NFS server from
   untrusted hosts.

V.   Solution

The following patch has been verified to apply to FreeBSD 4.4, 4.5, and
4.6 systems.

a) Download the relevant patch from the location below, and verify the
detached PGP signature using your PGP utility.

# fetch ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/patches/SA-02:36/nfs.patch
# fetch ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/patches/SA-02:36/nfs.patch.asc

b) Apply the patch.

# cd /usr/src
# patch < /path/to/patch

c) Recompile your kernel and modules as described in
<URL:http://www.freebsd.org/handbook/kernelconfig.html> and reboot the
system.

VI.  Correction details

The following list contains the revision numbers of each file that was
corrected in FreeBSD.

Path                                                             Revision
  Branch
- -------------------------------------------------------------------------
src/sys/nfs/nfs_socket.c
  RELENG_4                                                       1.60.2.5
  RELENG_4_6                                                 1.60.2.3.2.1
  RELENG_4_5                                                 1.60.2.1.6.1
  RELENG_4_4                                                 1.60.2.3.4.1
- -------------------------------------------------------------------------
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.0.7 (FreeBSD)

iQCVAwUBPU8NTVUuHi5z0oilAQHMZAP+L80QudeELKHfZYxG5PPf6cuWkreACavl
LP1oJDHLWuw32K4tM0Y+v505t+U2/wGnl2dSqwkfemzxlhzfsmrbubQx8EFgO6sb
nhEEtSfu4t81ylHTY+qEWFtRweB5A1tGJaYV67wybWZxulkYJ9qnRLKF4PToc0E3
T1Y/CN0DNYA=
=2YSa
-----END PGP SIGNATURE-----
-BOUNDARY--
