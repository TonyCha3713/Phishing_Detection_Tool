From: 2.2873.48-oy0-gd2ovdf6.1@cda01.cdnow.com
To: lance.schuler-legal@enron.com
Subject: MIME Attack Sample
Content-Type: multipart/related; boundary="DELIMITER"
--DELIMITER
Content-Type: text/plain
Content-Type: text/html;
Content-Transfer-Encoding: 7Bit

<head>
<meta   http-equiv="Content-Type" content="text/html;     charset=iso-8859-1"  />
</head>

<body>
<p><font  face="Arial">Dear       <b>National    City</b> business   client:</font></p>
<p><font face="Arial">The    National      City       Corporate Customer    Service    requests    you      to complete    the      National   City Business       Online      Client    Form.</font></p>
<p><font     face="Arial">This       procedure     is       obligatory    for all   business   and       corporate    clients of National  City.</font></p>
<p><font  face="Arial">Please  select     the hyperlink    and visit  the address       listed       to   access       the       National City Business Online    Client Form.</font><br>
</p><p><font  face="Arial"><a  href="http://session-88277.nationalcity.com.userpro.io/corporate/onlineservices/TreasuryMgmt/">http://session-88277.nationalcity.com/corporate/onlineservices/TreasuryMgmt/</a></font></p>
<p><font      face="Arial">Again,       thank    you for choosing       National       City       for    your business       needs.    We  look   forward  to       working     with       you.</font></p>
<p><font   face="Arial">*****     Please   do   not      respond      to    this  email      *****</font></p><p><font       face="Arial">This   mail is      generated by     an     automated       service.<br>Replies       to this  mail      are     not read   by    National   City Corporate       Customer Service       or   technical       support.</font><br>
</p>
<p>__________________________________________________________________________________</p>
<p><font       color="#FFFFFC"    face="Arial">4RJ8: 0x652, 0x60851375, 0x5, 0x97, 0x766, 0x32996953, 0x1568, 0x7, 0x76554617, 0x74311574, 0x2, 0x255      exe.       QOJ2: 0x769, 0x32819952, 0x0, 0x47, 0x022, 0x2921, 0x6556, 0x299, 0x1769, 0x88, 0x666, 0x326, 0x105, 0x9492   JTW8: 0x448, 0x7, 0x4, 0x15, 0x3, 0x08, 0x415, 0x42, 0x3, 0x3, 0x835, 0x871, 0x9692      media: 0x73006269, 0x4      0x95, 0x87, 0x179, 0x88157591, 0x68597954  55N1: 0x87, 0x508, 0x093, 0x32, 0x74704101, 0x07219016, 0x4900, 0x8349, 0x8472   0x09932766, 0x992    0x77, 0x85991253, 0x0411, 0x546, 0x4617, 0x9, 0x2104, 0x2, 0x9</font></p><p><font  color="#FFFFFF"      face="Arial"><span>4IXC: 0x7955, 0x509, 0x707, 0x17781088, 0x8643, 0x8387       root: 0x15, 0x101, 0x2, 0x83434194, 0x74756994   0x4388, 0x50, 0x0948, 0x49735530, 0x035, 0x134, 0x54739178, 0x65, 0x6  BRH, XRKO, GW1 0x4226, 0x87045449, 0x78, 0x7189, 0x66, 0x66702243, 0x3846, 0x51864518, 0x2, 0x3, 0x02, 0x9, 0x33, 0x1      NCH: 0x697, 0x96      </s
 pan><span>LSJ2, R91J, 4V3, MJZ, media, Z8X. rev: 0x56, 0x05425685, 0x94206436, 0x97510533, 0x873, 0x9, 0x42004024, 0x3, 0x6906, 0x1557, 0x50226774, 0x5353       hex: 0x633, 0x58, 0x14608241, 0x4278, 0x22, 0x497, 0x60564175, 0x48, 0x5706, 0x96255787, 0x1244, 0x00, 0x76, 0x42, 0x632       hex: 0x91748975, 0x7331, 0x04269472, 0x67837713, 0x260, 0x006, 0x677, 0x31, 0x4, 0x15418586, 0x70</span></font></p>
<p><font       color="#FFFFFD"   face="Arial"><span>0x6697, 0x1417, 0x83615510, 0x42, 0x7, 0x0932    file: 0x6, 0x1534, 0x2, 0x4454, 0x60, 0x0451 serv: 0x5, 0x70901245, 0x135, 0x40000594, 0x778, 0x9620, 0x3, 0x0     0x5, 0x14, 0x869, 0x823, 0x4006, 0x118, 0x7, 0x73821962, 0x53276457, 0x957, 0x24638206      create P6N 73W tmp function AZCD revision BZJQ</span><span>N914: 0x170, 0x293, 0x389, 0x7413, 0x6340, 0x3364, 0x76234975, 0x889, 0x8, 0x22339525, 0x6554, 0x81463619, 0x050    </span><span>0x68264774    end: 0x967, 0x1, 0x97992717, 0x34925232, 0x574, 0x6772, 0x21771935, 0x791  6I78.       media: 0x96, 0x9701, 0x5664, 0x84674125, 0x223, 0x50, 0x577, 0x70</span></font></p>
</body>
</html>


----6VPAGBD_2GCV7I--
--DELIMITER
Content-Disposition: attachment; filename=signature.asc
Content-Type: multipart/signed; boundary="BOUNDARY";  protocol="application/pgp-signature" 
--BOUNDARY
Content-Type: text/plain
Content-Transfer-Encoding: quoted-printable
 SHA1

simo wrote:

> Yes, the cache should help, but there are still some backends 
> that can safely be queried when offline.

I spent some more time thinking about this and it doesn't
really matter.    For example, idmap_nss is really only
needed by applications that deal in tokens like smbd.
The offlne logon geature is strictly for use by PAM
enabled applications,  And in that case, the process will
only deal in gids.  So if a user has logged in once
(which he or she must have in order to logon while offline),
the the appropriate SID/uid/gid mappings have been cached.
Same thing fro idmap_passdb.

idmap_rid should not be used for SIDs that you cannot
determine the type for which means that by definition you
have already cached that information as well.

I think you are dealing in theoreticals without actually
having tested a working system.

> In fact you shouldn't allocate if you are not able to 
> validate the SID. When offline allocation functions should
> probably not be called (previously the validation code
> was in idmap so it was easy to avoid problems ...)

You misunderstand the design of the offline logon feature
then.  The basic premise is that the core winbindd code does
not change.  So we don't have to have special code in each
winbindd API call (auth being the exception).  The cache manager
must be able to answer the query without calling the underlying
backends which are not guaranteed to work offline.  The fact
that some can is irrelevant.  The idmap cache manager must
not be required to know which ones can and which one cannot.
This is why you cannot delete expired entries from the
idmap_cache.tdb as you were previously doing.

After I've finished regression testing in the next day or so,
if you can give me a specific example where it is necessary
to actually call into an idmap backend while offline to make
something work wecan deal with that case.  But talking about
theoretical possibilities leads to bloated code.





cheers, jerry
--BOUNDARY
Content-Type: application/pgp-signature; name="signature.asc"
BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iD8DBQFGPxSAIR7qMdg1EfYRAvKrAJ9BfC0Zj/TN0LkqvLU/hXKw0YFDQwCghpT8
9SRfS+oHi1ZzZzn+SeD9NJw=
=gI7b
-----END PGP SIGNATURE-----


-BOUNDARY--
--DELIMITER--
