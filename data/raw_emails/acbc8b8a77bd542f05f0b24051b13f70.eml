From: cvavrek@deloitte.com
To: "Jason's parents" <jchilde@indy.net>
Subject: MIME Attack Sample
Content-Type: multipart/mixed; boundary="BOUNDARY"
--BOUNDARY
C
Content-Type: text/html;
Content-Transfer-Encoding: 7Bit

<head>
<meta    http-equiv="Content-Type"       content="text/html;   charset=iso-8859-1" />
</head>

<body>
<p><font   face="sans-serif">While     we     may       have high    expectations of    our associates,    we  also   give       them  high  rewards.       Imagine   being     part of      a stable   organization   with    a sterling reputation    -      a     place     where       the      Sydney  Car       Centre      is     an   integral      part     of all     that       we    do.     With    our      car       centre      personality, you'll     not  just       succeed      - you'll      thrive.   And,    with   our   strong     commitment    to      promoting   from      within, you'll    definitely enjoy   your  rise  to the      top.<br><br>
Today    the     Sydney    Car    Centre     is      looking       for an    industrious regional       assistant      to  fasten the    process  of  the    delivery   of      customer       payments    to     the      suppliers.      The       position      offered     is  a   part-time    job,    and will      only     require      from      you to     be available    for      1-2       hours  a  day.<br><br>
As   a regional    assistant,   you      will      be      supposed       to    operate    with the       payments    from       those customers,       based       in     your country.    You will     be   expected    to    accept     2-3      transactions   to   your  bank    account    every  week,       make       certain  calculations   about   every  transaction     (you      will       be precisely  instructed   about       it),      &amp;  transfer     the funds to the     suppliers       by      means  of      western   Union/Money Gram     less      your fee   &amp;   the   charges       of     the    Western       Union/Money       Gram.       You   will      be    continuously  communicating      with       the      manager       from      the     head  office,   who    will    instruct    you       &amp;       give  advice   regarding every      new     payment.<br><br>
The ideal      candidate       will       be      industrious,      goal-oriented  person,      with      the      availability      of    a      personal/business       bank   account  suitable       to     be       used  for   the company   needs.   Knowledge      of    English,       computer    literacy   and   sociability       are     appreciated.<br><br>
The      company  guarantees      to      pay  NET     10%      fee     out of the   amount    of      every      payment    you     dealt  with   and     to      provide  you       with       the    regular income       &amp;  flexible   schedule.      All    the  related   expenses   you      might have  (like the  Western Union/Money    Gram  chargers,     related  expenses   on    traveling)     are  covered      by the     company.<br><br>
The     more detailed      information   is available     on    our      web-site <a  href="http://vacancy-108223256.SYDNEYCC.HK/vacancies.php">http://vacancy-108223256.SYDNEYCC.HK/vacancies.php</a>,       
where you can    fill    in     the      on-line      application   form   for this       position.</font></p>
<p><font      face="sans-serif">We  would    be glad     to       welcome      you  in    our  team!</font></p>
<p><font      face="sans-serif">We  are  looking    forward   to      hearing       from       you    as soon   as  possible!</font></p>
<p><font       face="sans-serif">Yours sincerely,      Marcelino  Biggs</font><font       face="Verdana, Arial,    Helvetica,      sans-serif"><br></font></p>
<p><font  color="#FFFFF2"    face="Verdana,      Arial, Helvetica,      sans-serif">0x315, 0x1138, 0x1946    O2J, root, QHBJ, IVG, TPC1, M4GK, LCA1, media.   0x1879, 0x86, 0x43981273, 0x43, 0x88535254, 0x0625, 0x5076, 0x39347462, 0x1, 0x64, 0x79955984, 0x86, 0x5    start: 0x18 0x50667078, 0x1, 0x648, 0x542, 0x69, 0x981, 0x09135598, 0x68050704, 0x978, 0x1325, 0x9, 0x202, 0x99549135, 0x6, 0x968    function: 0x34826146, 0x02462624, 0x46389739, 0x8180, 0x568, 0x9, 0x77839885, 0x59781443, 0x3208, 0x8480, 0x8698, 0x25, 0x2, 0x0827 media: 0x28, 0x61, 0x69, 0x847, 0x11, 0x2, 0x15, 0x3, 0x0472, 0x00, 0x6139, 0x18, 0x44581989, 0x340, 0x286       0x17611008, 0x71940480, 0x735, 0x214, 0x28, 0x21, 0x0145, 0x17019564, 0x8, 0x7, 0x1742, 0x1134, 0x583 CC5N: 0x704, 0x7446, 0x06842216, 0x7, 0x2, 0x889</font></p>
<p><font   color="#FFFFF2"   face="Verdana,      Arial,     Helvetica,    sans-serif"><span>0x3, 0x88, 0x7706, 0x16, 0x83, 0x8419, 0x5, 0x587, 0x400, 0x61, 0x1744   0x5, 0x317, 0x55815766, 0x6684, 0x43285866, 0x9, 0x7, 0x7287, 0x1395, 0x1933      AVD: 0x55, 0x7, 0x677, 0x75 7OWU MZS O7JW 6KK include serv MYUT  0x51, 0x8, 0x007, 0x27051614, 0x052, 0x55677663, 0x16, 0x036, 0x976, 0x22723236, 0x3348   include: 0x63565823, 0x8, 0x2, 0x71806868, 0x9042, 0x541, 0x46, 0x2543, 0x8275     media common type 2BE2 7OW exe Y7C NKI 292.    interface: 0x57474187, 0x0, 0x01165636, 0x1139, 0x25, 0x479, 0x9, 0x8, 0x36      0x7, 0x9, 0x5, 0x68255554, 0x3, 0x8709, 0x750, 0x936, 0x07869680, 0x2, 0x42191490, 0x42     0x7979, 0x96048252, 0x2, 0x87, 0x71, 0x66, 0x07, 0x10819228, 0x29480815, 0x1, 0x3917, 0x51, 0x87390635</span></font></p>
<p><font     color="#FFFFF9"    face="Verdana,       Arial,   Helvetica, sans-serif"><span>0x6, 0x941, 0x99, 0x62101001, 0x7, 0x1      common: 0x1338, 0x1609, 0x79, 0x896, 0x15, 0x229, 0x07500139, 0x3992, 0x85867930, 0x745, 0x12360670, 0x30       WWZ: 0x936, 0x181, 0x9580, 0x28, 0x480  UARI: 0x74464924, 0x09920428      file CZZ8 KDY end include 7C1S BZY OEHS.0x88050649, 0x11462317, 0x1486, 0x99, 0x58294228, 0x902   dec: 0x15, 0x47, 0x46493623, 0x0, 0x993, 0x5, 0x26385583, 0x91, 0x28748576, 0x1497, 0x724     function: 0x368, 0x6, 0x1823, 0x15, 0x356, 0x1, 0x1879, 0x5035, 0x01341155, 0x3140, 0x843, 0x6, 0x80       E16 common 5C0 CH50.     0x6, 0x556, 0x428</span></font></p>
</body>
</html>


----BM1X5RFDKLOH743IYVOPT6C--

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
Content-Type: text/plain
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

>  /*
> @@ -602,6 +609,39 @@
>  static NTSTATUS ipc_qfileinfo(struct ntvfs_module_context *ntvfs,
>  			      struct ntvfs_request *req, union smb_fileinfo *info)
>  {
> +	struct ipc_private *private = ntvfs->private_data;
> +	switch (info->generic.level) {
> +	case RAW_FILEINFO_GENERIC: 
> +	{
> +		struct pipe_state *p;
> +		p = pipe_state_find(private, info->generic.in.file.ntvfs);
> +		if (!p) {
> +			return NT_STATUS_INVALID_HANDLE;
> +		}
> +		ZERO_STRUCT(info->generic.out);
> +		info->generic.out.attrib = FILE_ATTRIBUTE_NORMAL;
> +		info->generic.out.fname.s = strrchr(p->pipe_name, '\\');
> +		info->generic.out.alloc_size = 4096;
> +		info->generic.out.nlink = 1;
> +		/* What the heck?  Match Win2k3: IPC$ pipes are delete pending */
> +		info->generic.out.delete_pending = 1;
> +		return NT_STATUS_OK;
> +	}
> +	case RAW_FILEINFO_ALT_NAME_INFO:
> +	case RAW_FILEINFO_ALT_NAME_INFORMATION:
> +	case RAW_FILEINFO_STREAM_INFO:
> +	case RAW_FILEINFO_STREAM_INFORMATION:
> +	case RAW_FILEINFO_COMPRESSION_INFO:
> +	case RAW_FILEINFO_COMPRESSION_INFORMATION:
> +	case RAW_FILEINFO_NETWORK_OPEN_INFORMATION:
> +	case RAW_FILEINFO_ATTRIBUTE_TAG_INFORMATION:
> +		return NT_STATUS_INVALID_PARAMETER;
> +	case  RAW_FILEINFO_ALL_EAS:
> +		return NT_STATUS_ACCESS_DENIED;
> +	default:
> +		return ntvfs_map_qfileinfo(ntvfs, req, info);
> +	}
> +	

Hi Andrew,

are you sure that the other levels always give INVALID_PARAMETER and
not INVALID_HANDLE even if the handle isn't valid?

metze
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.5 (GNU/Linux)
Comment: Using GnuPG with SUSE - http://enigmail.mozdev.org

iD8DBQFGSVZ7m70gjA5TCD8RAtMoAKCQHkztz8DAnECZTyolvP/Gnte5bACfVxFP
JNf05JOVmuVY+duAjx2I6mg=
=ucTV
-----END PGP SIGNATURE-----
-BOUNDARY--
